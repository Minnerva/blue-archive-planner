import{u as P,c as he,o as d,a as f,b as r,d as h,t as $,e as H,g as _e,G as Ve,s as Oe,f as Ee,h as D,i as Ge,j as je,k as K,l as qe,r as Ae,m,F as z,n as ee,p as Ke,q as ze,v as Me,w as We,x as Je,y as Ze,z as Be,A as Qe,B as Xe,D as et,E as tt,H as st,I as at,J as fe,K as A,L as v,M as Y,N as Re,O as Z,P as Ue,Q as ge,R as be,S as nt,T as ot,U as rt,V as it}from"./vendor-BQVWAgHc.js";import{C as Le}from"./chart.js-ddEKr6i1.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function a(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=a(n);fetch(n.href,o)}})();const lt="/gacha-tracker-online/assets/logo-QuR3q7Cb.png",ct={class:"w-full h-12 bg-white shadow md:px-4 sm:px-6 px-4 sticky top-0 z-10"},ut={class:"flex h-full items-center"},dt={class:"flex-none w-14"},_t=["src"],ft={class:"flex-1 flex justify-end items-center"},mt=["title"],pt={class:"w-20"},yt={__name:"Nav",setup(e){const t=P(),a=he(()=>t.state.user),s=()=>{const o=_e(),i=new Ve;Oe(o,i).then(_=>{}).catch(_=>{console.log(_)})},n=()=>{const o=_e();Ee(o).then(i=>{}).catch(i=>{console.log(i)})};return(o,i)=>(d(),f("div",ct,[r("div",ut,[r("div",dt,[r("img",{src:h(lt)},null,8,_t)]),r("div",ft,[a.value?(d(),f("span",{key:0,class:"mr-3 truncate max-w-52",title:a.value.ign},$(a.value.ign),9,mt)):H("",!0),r("div",pt,[a.value?(d(),f("button",{key:1,onClick:n,class:"bg-white w-full p-1 border rounded-lg"},"Sign Out")):(d(),f("button",{key:0,onClick:s,class:"bg-white w-full p-1 border rounded-lg"},"Sign In"))])])])]))}},ht={__name:"App",setup(e){D.extend(Ge);const t=P(),s=je({apiKey:"AIzaSyB8hRY_mV19i_4K-Mno7Sn8FpOJGEIvDKM",authDomain:"gacha-tracker-online.firebaseapp.com",projectId:"gacha-tracker-online",storageBucket:"gacha-tracker-online.appspot.com",messagingSenderId:"395636017581",appId:"1:395636017581:web:2f03e7f80569c9a537b924",measurementId:"G-HW1B3NSFH8",databaseURL:"https://gacha-tracker-online-default-rtdb.asia-southeast1.firebasedatabase.app/"}),n=_e(s);return K(s),qe(s),n.onAuthStateChanged(async o=>{if(!o&&t.state.user)window.location.reload();else if(!o)t.commit("setUser",!1);else{t.commit("setUID",o.uid);let i={};const _=D.utc().format("YYYY-MM-DD HH:mm:ss");t.dispatch("setUserListen",u=>{t.state.user||(u?(i={...u},i.last_signed_in_at=_):i={ign:"",active:!1,created_at:_,last_signed_in_at:_},t.dispatch("saveUser",i)),u&&t.commit("setUser",u)})}}),(o,i)=>{const _=Ae("router-view");return d(),f(z,null,[m(yt),m(_)],64)}}},gt=e=>(e&&e[0]==="/"&&(e=e.substring(1)),`/gacha-tracker-online/${e||""}`),bt=(e,t)=>{let a=-1;const s=Object.keys(t);return e.forEach((n,o)=>{const i=[];if(s.forEach(_=>{n[_]===t[_]&&i.push(!0)}),i.length===s.length)return a=o,o}),a},kt=(e,t)=>e.filter(a=>{let s=[];for(let n in t)s.push(t[n]===a[n]);return s.every(n=>n)}),vt=(e,t)=>{const a=[];for(let s in e)a.push(e[s]);return kt(a,t)},Ne=(e,t)=>{const a=bt(e,t);return a>-1?e[a]:!1},N=e=>D(`${e} 00:00:00`),Q=({pyroxene:e,free_pull:t})=>Math.floor(e/120)+t,Ce=e=>new Intl.NumberFormat("en-US",{}).format(e),wt=async e=>{const t=K();try{const s=(await ze(Ke(ee(t),e))).val();return s||!1}catch(a){console.error(a)}},xt=(e,t)=>{const a=K(),s=ee(a,e);Me(s,n=>{const o=n.val();t(o)})},q=(e,t)=>{const a=K();We(ee(a,e),t)},G=(e,t,a={})=>{a.filters||(a.filters=[]);const s=K(),n=[];let o=null;switch(a.order){case"child":n.push(Ze(a.order_key));break;case"key":n.push(Je());break;case"value":n.push(orderByValue(a.order_key));break}a.filters.forEach(i=>{switch(i.type){case"first":n.push(tt(i.value));break;case"last":n.push(et(i.value));break;case"between":a.order==="key"&&(n.push(Be(i.start)),n.push(Xe(i.end)));break;case"endBefore":a.order==="key"&&n.push(Qe(i.value));break;case"startAt":a.order==="key"&&n.push(Be(i.value));break}}),o=st(ee(s,e),...n),Me(o,i=>t(i.val()))},$t={namespaced:!0,state:{DB_PATH_BA_BANNER_PULL:"/ba-banner-pull",banner_pull:!1,listGetUpcomingListener:!1},mutations:{setBannerPull(e,t){e.banner_pull=t?{...t}:!1}},getters:{find:e=>t=>{const a=e.banner_pull[t];return a||null}},actions:{save({state:e,rootState:t},{key:a,data:s}){q(`${e.DB_PATH_BA_BANNER_PULL}/${t.uid}/${a}`,s)},delete({state:e,rootState:t},a){q(`${e.DB_PATH_BA_BANNER_PULL}/${t.uid}/${a}`,null)},setGetUpcomingRecordsListen({state:e,rootState:t},a){const{listGetUpcomingListener:s}=e;s&&(s.off(),e.listGetUpcomingListener=!1),e.listLatestListener=G(`${e.DB_PATH_BA_BANNER_PULL}/${t.uid}`,a,{order:"key",filters:[{type:"startAt",value:"2023-12-00"}]})}}},Bt={namespaced:!0,state:{DB_PATH_BA_CURRENCY_OWN:"/ba-currency-own",listGetListener:!1,listLatestListener:!1,listLatestBeforeMonthListener:!1},actions:{save({state:e,rootState:t},{key:a,data:s}){q(`${e.DB_PATH_BA_CURRENCY_OWN}/${t.uid}/${a}`,s)},setGetRecordsListen({state:e,rootState:t},{year:a,month:s,callback:n}){const{listGetListener:o}=e;o&&(o.off(),e.listGetListener=!1),e.listLatestListener=G(`${e.DB_PATH_BA_CURRENCY_OWN}/${t.uid}`,n,{order:"key",filters:[{type:"between",start:`${a}-${s}-00`,end:`${a}-${s}-99`}]})},setGetLatestRecordListen({state:e,rootState:t},a){const{listLatestListener:s}=e;s&&(s.off(),e.listLatestListener=!1),e.listLatestListener=G(`${e.DB_PATH_BA_CURRENCY_OWN}/${t.uid}`,a,{filters:[{type:"last",value:1}]})},setGetLatestBeforeMonthListener({state:e,rootState:t},{year:a,month:s,callback:n}){const{listLatestBeforeMonthListener:o}=e;o&&(o.off(),e.listLatestBeforeMonthListener=!1),e.listLatestBeforeMonthListener=G(`${e.DB_PATH_BA_CURRENCY_OWN}/${t.uid}`,n,{order:"key",filters:[{type:"endBefore",value:`${a}-${s}-00`},{type:"last",value:1}]})}}},Lt={namespaced:!0,state:{DB_PATH_BA_CURRENCY_USE:"/ba-currency-use",listGetListener:!1},actions:{save({state:e,rootState:t},{key:a,data:s}){q(`${e.DB_PATH_BA_CURRENCY_USE}/${t.uid}/${a}`,s)},setGetRecordsListen({state:e,rootState:t},{year:a,month:s,callback:n}){const{listGetListener:o}=e;o&&(o.off(),e.listGetListener=!1),e.listLatestListener=G(`${e.DB_PATH_BA_CURRENCY_USE}/${t.uid}`,n,{order:"key",filters:[{type:"between",start:`${a}-${s}-00`,end:`${a}-${s}-99`}]})}}},Ct={"ba-banner-pull":$t,"ba-currency-own":Bt,"ba-currency-use":Lt},Yt=at({state:{DB_PATH_USER:"/users",DB_PATH_BLUE_ARCHIVE_CURRENCY:"/blue-archive-currencies",user:!1,uid:!1},mutations:{setUser(e,t){e.user=t?{...t}:!1},setUID(e,t){e.uid=t||!1}},actions:{findUser({state:e}){return wt(`${e.DB_PATH_USER}/${e.uid}`)},setUserListen({state:e},t){xt(`${e.DB_PATH_USER}/${e.uid}`,a=>t(a))},async saveUser({state:e},t){await q(`${e.DB_PATH_USER}/${e.uid}`,t)}},modules:Ct}),Dt={class:"relative shadow bg-white rounded-sm"},E={__name:"Card",props:{noPadding:{type:Boolean,default:!1}},setup(e){return(t,a)=>(d(),f("div",Dt,[fe(t.$slots,"cover"),r("div",{class:A({"p-3":!e.noPadding})},[fe(t.$slots,"body")],2)]))}},At=(e,t)=>{const a=e.__vccOpts||e;for(const[s,n]of t)a[s]=n;return a},Mt={class:"relative"},Rt=["src","title"],Ut=["placeholder","type","value"],Nt={__name:"Base",props:{danger:{type:Boolean,default:!1},icon:{},iconTitle:{},modelValue:{},type:{default:"text"},placeholder:{default:""},onChange:{type:Function,default(){return()=>{}}}},emits:["update:modelValue"],setup(e){const t=e,a=()=>{const{danger:s}=t;return s?["border-danger"]:["border-primary"]};return(s,n)=>(d(),f("div",Mt,[e.icon?(d(),f("img",{key:0,class:"absolute w-8 max-h-5 inset-y-0 m-auto z-10",src:e.icon,title:e.iconTitle},null,8,Rt)):H("",!0),r("input",{class:A(["w-full h-7 border-2 drop-shadow-sm focus:outline-0",[{"pl-4":!e.icon,"pl-9":e.icon},a()]]),placeholder:e.placeholder,type:e.type,value:e.modelValue,onInput:n[0]||(n[0]=o=>s.$emit("update:modelValue",o.target.value)),onChange:n[1]||(n[1]=(...o)=>e.onChange&&e.onChange(...o))},null,42,Ut)]))}},j=At(Nt,[["__scopeId","data-v-1d9c3069"]]),Pe={__name:"Base",props:{primary:Boolean,danger:Boolean,onClick:Function},setup(e){const t=e,a=()=>({"border-2":!t.primary&&!t.danger,"text-white":t.primary||t.danger,"bg-primary":t.primary,"bg-danger":t.danger});return(s,n)=>(d(),f("button",{class:A(["rounded w-full h-8 select-none",[a()]]),onClick:n[0]||(n[0]=(...o)=>e.onClick&&e.onClick(...o))},[fe(s.$slots,"default")],2))}},Pt={class:"w-full py-3 md:px-8 sm:px-6 px-4"},Ht={key:0},St={class:"grid grid-cols-2 gap-4"},Tt={class:"col-span-full md:col-span-1"},It={key:1},Ft={__name:"Main",setup(e){const t=P(),a=he(()=>t.state.user),s=v(""),n=()=>{const{user:o}=t.state;o.ign=s,t.dispatch("saveUser",o)};return(o,i)=>{const _=Ae("router-view");return d(),f("div",Pt,[a.value?(d(),f(z,{key:0},[a.value.ign?a.value.active?(d(),Re(_,{key:2})):(d(),f("div",It,"Please contact Minnerva to activate your account.")):(d(),f("div",Ht,[m(E,null,{body:Y(()=>[r("div",St,[r("label",Tt,[Z(" Input your IGN or Discord Name: "),m(j,{modelValue:s.value,"onUpdate:modelValue":i[0]||(i[0]=u=>s.value=u)},null,8,["modelValue"])]),m(Pe,{class:"col-span-full md:col-start-1 md:col-end-2","on-click":n,primary:""},{default:Y(()=>[Z("Submit")]),_:1})])]),_:1})]))],64)):H("",!0)])}}},Vt="/gacha-tracker-online/assets/akane-bunny-icon-gfOjhgOr.webp",Ot="/gacha-tracker-online/assets/asuna-bunny-icon-oF1effRe.webp",Et="/gacha-tracker-online/assets/hanako-swimsuit-icon-s2k28dzI.webp",Gt="/gacha-tracker-online/assets/hare-camping-icon-xHKeVTgU.webp",jt="/gacha-tracker-online/assets/haruna-tracksuit-icon-C3yJc6jX.webp",qt="/gacha-tracker-online/assets/himari-icon-NnOzyjRg.webp",Kt="/gacha-tracker-online/assets/hina-swimsuit-icon-3-IoiTOU.webp",zt="/gacha-tracker-online/assets/hinata-swimsuit-icon-Vx2yAU8s.webp",Wt="/gacha-tracker-online/assets/iori-swimsuit-icon-5HfIKnaa.webp",Jt="/gacha-tracker-online/assets/karin-bunny-icon-z90yfVlX.webp",Zt="/gacha-tracker-online/assets/kayoko-new-year-icon-lEZ08tqZ.webp",Qt="/gacha-tracker-online/assets/kikyou-icon-OCtBoToh.webp",Xt="/gacha-tracker-online/assets/kotama-camping-icon-j0Rln9bx.webp",es="/gacha-tracker-online/assets/mari-tracksuit-icon-IfCWZ2Vl.webp",ts="/gacha-tracker-online/assets/mimori-swimsuit-icon-ICDRkuj4.webp",ss="/gacha-tracker-online/assets/misaka-mikoto-icon-t-m5DYfT.webp",as="/gacha-tracker-online/assets/miyako-swimsuit-icon-9NTUwO2x.webp",ns="/gacha-tracker-online/assets/neru-bunny-icon-QPIKLGG6.webp",os="/gacha-tracker-online/assets/nonomi-swimsuit-icon-Yyj40vp2.webp",rs="/gacha-tracker-online/assets/renge-icon-nMq9xxcQ.webp",is="/gacha-tracker-online/assets/saki-swimsuit-icon-y07xpALf.webp",ls="/gacha-tracker-online/assets/shiroko-swimsuit-icon-gmc76iBJ.webp",cs="/gacha-tracker-online/assets/shokuhou-misaki-icon-r8ShdIbR.webp",us="/gacha-tracker-online/assets/ui-swimsuit-icon-Y8SkXBci.webp",ds="/gacha-tracker-online/assets/wakamo-swimsuit-icon-aFL8264u.webp",_s="/gacha-tracker-online/assets/yukari-icon-lJbTFHeZ.webp",fs="/gacha-tracker-online/assets/yuuka-tracksuit-icon-obYhk5gg.webp";let me=[{name:"Akane",alter:"Bunny"},{name:"Asuna",alter:"Bunny"},{name:"Hanako",alter:"Swimsuit"},{name:"Hare",alter:"Camping"},{name:"Haruna",alter:"Tracksuit"},{name:"Himari",alter:""},{name:"Hina",alter:"Swimsuit"},{name:"Hinata",alter:"Swimsuit"},{name:"Iori",alter:"Swimsuit"},{name:"Karin",alter:"Bunny"},{name:"Kayoko",alter:"New Year"},{name:"Kikyou",alter:""},{name:"Kotama",alter:"Camping"},{name:"Mari",alter:"Tracksuit"},{name:"Mimori",alter:"Swimsuit"},{name:"Misaka Mikoto",alter:""},{name:"Miyako",alter:"Swimsuit"},{name:"Neru",alter:"Bunny"},{name:"Nonomi",alter:"Swimsuit"},{name:"Renge",alter:""},{name:"Saki",alter:"Swimsuit"},{name:"Shiroko",alter:"Swimsuit"},{name:"Shokuhou Misaki",alter:""},{name:"Ui",alter:"Swimsuit"},{name:"Wakamo",alter:"Swimsuit"},{name:"Yukari",alter:""},{name:"Yuuka",alter:"Tracksuit"}];me=me.map(e=>(e.full_name=e.alter?`${e.name} (${e.alter})`:e.name,e.key=e.full_name.replace(/[()]/g,"").replace(/\s/g,"-").toLocaleLowerCase(),e.icon=new URL(Object.assign({"/src/assets/students/akane-bunny-icon.webp":Vt,"/src/assets/students/asuna-bunny-icon.webp":Ot,"/src/assets/students/hanako-swimsuit-icon.webp":Et,"/src/assets/students/hare-camping-icon.webp":Gt,"/src/assets/students/haruna-tracksuit-icon.webp":jt,"/src/assets/students/himari-icon.webp":qt,"/src/assets/students/hina-swimsuit-icon.webp":Kt,"/src/assets/students/hinata-swimsuit-icon.webp":zt,"/src/assets/students/iori-swimsuit-icon.webp":Wt,"/src/assets/students/karin-bunny-icon.webp":Jt,"/src/assets/students/kayoko-new-year-icon.webp":Zt,"/src/assets/students/kikyou-icon.webp":Qt,"/src/assets/students/kotama-camping-icon.webp":Xt,"/src/assets/students/mari-tracksuit-icon.webp":es,"/src/assets/students/mimori-swimsuit-icon.webp":ts,"/src/assets/students/misaka-mikoto-icon.webp":ss,"/src/assets/students/miyako-swimsuit-icon.webp":as,"/src/assets/students/neru-bunny-icon.webp":ns,"/src/assets/students/nonomi-swimsuit-icon.webp":os,"/src/assets/students/renge-icon.webp":rs,"/src/assets/students/saki-swimsuit-icon.webp":is,"/src/assets/students/shiroko-swimsuit-icon.webp":ls,"/src/assets/students/shokuhou-misaki-icon.webp":cs,"/src/assets/students/ui-swimsuit-icon.webp":us,"/src/assets/students/wakamo-swimsuit-icon.webp":ds,"/src/assets/students/yukari-icon.webp":_s,"/src/assets/students/yuuka-tracksuit-icon.webp":fs})[`/src/assets/students/${e.key}-icon.webp`],import.meta.url).href,e));const He=me,pe="/gacha-tracker-online/assets/pyroxene-gBHgCIjf.webp",ye="/gacha-tracker-online/assets/recruitment-ticket-NiO_EDI9.webp",Ye="chart",ms={__name:"LineChart",props:{labels:{type:Array,required:!0},data:{type:Array,required:!0},pullBanners:{type:Array,default(){return[]}}},setup(e,{expose:t}){const a=e;let s=null;const n={};Ue(a,()=>{o()}),Le.register({id:"default",afterDatasetsDraw(_){const u=_.getDatasetMeta(0).data;if(u.length>0){const{ctx:p}=_,g=14*_.currentDevicePixelRatio,S=16*_.currentDevicePixelRatio;u.forEach(({$context:te},L)=>{const T=_.getDatasetMeta(1).data[L],M=te.raw,W=T.$context.raw;if((M||W)&&a.pullBanners[L]){const se=M?u[L].x:T.x,J=M?u[L].y:T.y;a.pullBanners[L].forEach((ae,ne)=>{const w=Ne(He,{key:ae.student_key});if(w){if(!n[w.key]){const l=new Image(g,S);l.src=w.icon,n[w.key]=l}p.drawImage(n[w.key],se-g/2,J-(-10+ne*-1*S),g,S)}})}})}}});const o=()=>{s.data.labels=a.labels,a.data.forEach((_,u)=>{s.data.datasets[u].data=_}),s.update()},i=()=>{s=new Le(document.querySelector(`#${Ye}`),{type:"line",data:{labels:[],datasets:[{data:[],borderColor:"#00D8FB",backgroundColor:"#FFFFFF"},{data:[],borderColor:"#FFE9F2",backgroundColor:"#FFFFFF"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},animation:{},scales:{x:{ticks:{autoSkip:!0,maxTicksLimit:10}},y:{beginAtZero:!0}}}})};return ge(()=>{i()}),t({updateChart:o}),(_,u)=>(d(),f("canvas",{id:Ye}))}},ps={class:"flex items-center"},ys=["src","title"],O={__name:"HistorySub",props:{icon:{required:!0},iconTitle:{},own:{required:!0},diff:{},danger:{type:Boolean,default:!1}},setup(e){const t=s=>{if(s>0)return"text-success";if(s<0)return"text-danger"},a=s=>`(${s>=0?"+":""}${Ce(s)})`;return(s,n)=>(d(),f("div",ps,[r("img",{class:"w-8 mr-2",src:e.icon,title:e.iconTitle},null,8,ys),r("span",{class:A({"text-danger":e.danger})},$(h(Ce)(e.own)),3),e.diff&&e.diff!==0?(d(),f("span",{key:0,class:A(["ml-1 text-xs",t(e.diff)])},$(a(e.diff)),3)):H("",!0)]))}},Se="/gacha-tracker-online/assets/icon-pulls-PmRtrI9p.png",hs={class:"grid grid-cols-2 gap-3"},gs={class:"col-span-1 border-r"},bs=r("div",{class:"text-center text-xs pb-2"},"Record",-1),ks={key:0,class:"col-span-1"},vs=r("div",{class:"text-center text-xs pb-2"},"Use",-1),ws={class:"col-span-full flex justify-center"},xs={__name:"History",props:{item:{required:!0},use:{default:!1}},setup(e){const t=v(D()),a=s=>s===t.value.format("YYYY-MM-DD")?["text-primary","font-bold"]:[];return(s,n)=>(d(),f("div",hs,[r("div",{class:A(["col-span-2",a(e.item.date)])},$(e.item.date),3),r("div",gs,[bs,m(O,{icon:h(pe),"icon-title":"Pyroxene",own:e.item.pyroxene,diff:e.item.diff_pyroxene},null,8,["icon","own","diff"]),m(O,{icon:h(ye),"icon-title":"Pull Ticket",own:e.item.free_pull,diff:e.item.diff_free_pull},null,8,["icon","own","diff"])]),e.use?(d(),f("div",ks,[vs,m(O,{icon:h(pe),"icon-title":"Pyroxene",own:e.use.pyroxene,danger:""},null,8,["icon","own"]),m(O,{icon:h(ye),"icon-title":"Pull Ticket",own:e.use.free_pull,danger:""},null,8,["icon","own"])])):H("",!0),r("div",ws,[m(O,{icon:h(Se),"icon-title":"Total Pull",own:h(Q)(e.item),diff:h(Q)({pyroxene:e.item.diff_pyroxene,free_pull:e.item.diff_free_pull})},null,8,["icon","own","diff"])])]))}},$s={class:"flow-root"},Bs={class:"divide-y divide-gray-200 dark:divide-gray-700"},Ls={key:0,class:"py-3 sm:py-4"},Cs={__name:"History",props:{items:{required:!0},currencyUse:{default(){return{}}}},setup(e){return(t,a)=>(d(),f("div",$s,[r("ul",Bs,[!e.items||e.items.length<=0?(d(),f("li",Ls,"No record found.")):(d(!0),f(z,{key:1},be(e.items,s=>(d(),f("li",{key:s.date,class:"py-3 sm:py-4"},[m(xs,{item:s,use:e.currencyUse[s.date]},null,8,["item","use"])]))),128))])]))}};let X=[{date:"2023-09-26",duration:7,student_key:"kayoko-new-year"},{date:"2024-01-09",duration:7,student_key:"hina-swimsuit"},{date:"2024-01-09",duration:7,student_key:"iori-swimsuit"},{date:"2023-12-26",duration:14,student_key:"miyako-swimsuit"},{date:"2023-12-26",duration:14,student_key:"saki-swimsuit"},{date:"2024-01-16",duration:7,student_key:"shiroko-swimsuit"},{date:"2024-01-16",duration:7,student_key:"nonomi-swimsuit"},{date:"2024-01-16",duration:7,student_key:"wakamo-swimsuit"},{date:"2024-01-23",duration:9,student_key:"ui-swimsuit"},{date:"2024-01-23",duration:9,student_key:"hinata-swimsuit"},{date:"2024-02-01",duration:7,student_key:"hanako-swimsuit"},{date:"2024-02-15",duration:7,student_key:"mimori-swimsuit"},{date:"2024-03-16",duration:12,student_key:"haruna-tracksuit"},{date:"2024-03-16",duration:12,student_key:"yuuka-tracksuit"},{date:"2024-03-16",duration:12,student_key:"mari-tracksuit"},{date:"2024-04-18",duration:14,student_key:"misaka-mikoto"},{date:"2024-04-18",duration:14,student_key:"shokuhou-misaki"},{date:"2024-05-02",duration:8,student_key:"yukari"},{date:"2024-05-16",duration:14,student_key:"renge"},{date:"2024-05-16",duration:14,student_key:"kikyou"},{date:"2024-05-30",duration:7,student_key:"himari"},{date:"2024-06-13",duration:7,student_key:"karin-bunny"},{date:"2024-06-13",duration:7,student_key:"neru-bunny"},{date:"2024-06-13",duration:7,student_key:"akane-bunny"},{date:"2024-06-13",duration:7,student_key:"asuna-bunny"},{date:"2024-06-20",duration:14,student_key:"hare-camping"},{date:"2024-06-20",duration:14,student_key:"kotama-camping"}];X=X.map(e=>(e.key=`${e.date}-${e.student_key}`,e));X.sort((e,t)=>e.date>t.date?1:e.date<t.date?-1:0);const Ys=X,Ds={class:"grid grid-cols-10 gap-3 md:items-center"},As={class:"col-span-2 lg:col-span-2"},Ms=["src","title"],Rs={class:"col-span-8 lg:col-span-8"},Us={__name:"Banner",props:{item:{required:!0},bannerPull:{}},setup(e){const t=e,a=P(),s=v(null),n=Ne(He,{key:t.item.student_key});Ue(t,()=>{o()});const o=()=>{const u=a.getters["ba-banner-pull/find"](t.item.key);s.value=u?u.pull:null},i=()=>t.item.diff<=0?" - Live":` - ${t.item.diff} days`,_=()=>{const{item:u}=t,p=u.key;!s.value||s.value<=0?(a.dispatch("ba-banner-pull/delete",p),s.value=null):a.dispatch("ba-banner-pull/save",{key:p,data:{date:u.date,student_key:u.student_key,pull:s.value}})};return ge(()=>{o()}),(u,p)=>(d(),f("div",Ds,[r("div",As,[r("img",{src:h(n).icon,title:h(n).full_name},null,8,Ms)]),r("div",Rs,[r("div",null,$(e.item.date)+$(i()),1),r("div",null,$(h(n).full_name),1),r("div",null,[m(j,{modelValue:s.value,"onUpdate:modelValue":p[0]||(p[0]=g=>s.value=g),modelModifiers:{number:!0},placeholder:"200",icon:h(Se),"icon-title":"Pull",type:"number","on-change":_},null,8,["modelValue","icon"])])])]))}},Ns={class:"flow-root"},Ps={class:"divide-y divide-gray-200 dark:divide-gray-700"},Hs={key:0,class:"py-3 sm:py-4"},Ss={__name:"Banner",setup(e){const t=P(),a=he(()=>t.state["ba-banner-pull"].banner_pull),s=N(D().format("YYYY-MM-DD")),n=Ys.map(o=>{const i=N(o.date);return o.diff=i.diff(s,"day"),o}).filter(o=>o.diff>o.duration*-1);return(o,i)=>(d(),f("div",Ns,[r("ul",Ps,[h(n).length<=0?(d(),f("li",Hs,"No banner found.")):(d(!0),f(z,{key:1},be(h(n),_=>(d(),f("li",{key:_.key,class:"py-3 sm:py-4"},[m(Us,{item:_,"banner-pull":a.value[_.key]},null,8,["item","banner-pull"])]))),128))])]))}},Ts="data:image/svg+xml,%3c!--%20https://fontawesome.com/icons/chevron-left?f=classic&s=solid%20--%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='16'%20width='10'%20viewBox='0%200%20320%20512'%3e%3c!--!Font%20Awesome%20Free%206.5.1%20by%20@fontawesome%20-%20https://fontawesome.com%20License%20-%20https://fontawesome.com/license/free%20Copyright%202023%20Fonticons,%20Inc.--%3e%3cpath%20d='M9.4%20233.4c-12.5%2012.5-12.5%2032.8%200%2045.3l192%20192c12.5%2012.5%2032.8%2012.5%2045.3%200s12.5-32.8%200-45.3L77.3%20256%20246.6%2086.6c12.5-12.5%2012.5-32.8%200-45.3s-32.8-12.5-45.3%200l-192%20192z'/%3e%3c/svg%3e",Is="data:image/svg+xml,%3c!--%20https://fontawesome.com/icons/chevron-right?f=classic&s=solid%20--%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='16'%20width='10'%20viewBox='0%200%20320%20512'%3e%3c!--!Font%20Awesome%20Free%206.5.1%20by%20@fontawesome%20-%20https://fontawesome.com%20License%20-%20https://fontawesome.com/license/free%20Copyright%202023%20Fonticons,%20Inc.--%3e%3cpath%20d='M310.6%20233.4c12.5%2012.5%2012.5%2032.8%200%2045.3l-192%20192c-12.5%2012.5-32.8%2012.5-45.3%200s-12.5-32.8%200-45.3L242.7%20256%2073.4%2086.6c-12.5-12.5-12.5-32.8%200-45.3s32.8-12.5%2045.3%200l192%20192z'/%3e%3c/svg%3e",Fs="data:image/svg+xml,%3c!--%20https://fontawesome.com/icons/calendar?f=classic&s=regular&pc=%252300d8fb%20--%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='16'%20width='14'%20viewBox='0%200%20448%20512'%3e%3c!--!Font%20Awesome%20Free%206.5.1%20by%20@fontawesome%20-%20https://fontawesome.com%20License%20-%20https://fontawesome.com/license/free%20Copyright%202023%20Fonticons,%20Inc.--%3e%3cpath%20fill='%2300d8fb'%20d='M152%2024c0-13.3-10.7-24-24-24s-24%2010.7-24%2024V64H64C28.7%2064%200%2092.7%200%20128v16%2048V448c0%2035.3%2028.7%2064%2064%2064H384c35.3%200%2064-28.7%2064-64V192%20144%20128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24%2010.7-24%2024V64H152V24zM48%20192H400V448c0%208.8-7.2%2016-16%2016H64c-8.8%200-16-7.2-16-16V192z'/%3e%3c/svg%3e",Vs="/gacha-tracker-online/assets/mika-portrait-iOc64siT.webp",Os={class:"grid grid-cols-10 gap-4"},Es={class:"col-span-full md:col-span-8"},Gs={class:"flex justify-center text-center"},js=["src"],qs={class:"mx-4 text-xl md:text-3xl font-bold"},Ks=["src"],zs={class:"flex justify-center"},Ws={class:"w-full h-72"},Js={class:"text-sm font-medium text-center text-gray-500 border-b border-gray-200 dark:text-gray-400 dark:border-gray-700"},Zs={class:"grid grid-cols-2 gap-0"},Qs=["onClick"],Xs={class:"grid grid-cols-4 gap-4 p-3"},ea={class:"col-span-full"},ta={class:"col-span-full"},sa={class:"col-span-full"},aa={class:"col-span-full md:col-start-2 md:col-end-4 mt-4"},na=r("div",{class:"h-10 text-md0 md:text-xl font-bold border-b"},"History",-1),oa=r("div",{class:"h-10 text-md0 md:text-xl font-bold border-b"},"Upcoming Banners",-1),ra={class:"col-span-full md:col-span-full xl:col-span-2 grid items-center content-end"},ia={class:"text-center"},la=["src"],De=12e3/30,ca={__name:"Index",setup(e){const t=P(),a=v([{key:"record",label:"Record"},{key:"use",label:"Use"}]),s=v("record"),n=v(D()),o=v([]),i=v({}),_=v([]),u=v({date:"",pyroxene:0,free_pull:0}),p=nt({day:n.value.format("YYYY-MM-DD"),pyroxene:void 0,free_pull:void 0}),g=v({labels:[],data:[],pull_banners:[]}),S=l=>{if(l.key!==s.value)return["hover:text-gray-600","hover:border-gray-300","dark:hover:text-gray-300"];if(l.key==="record")return["font-bold","border-primary","text-primary"];if(l.key==="use")return["font-bold","border-danger","text-danger"]},te=l=>{s.value!==l&&(p.day=D().format("YYYY-MM-DD"),p.pyroxene=void 0,p.free_pull=void 0,s.value=l)},L=()=>{t.dispatch("ba-currency-own/setGetLatestRecordListen",l=>{if(l){const c=Object.keys(l);c.length>0&&(u.value={date:c[0],...l[c[0]]})}})},T=(l,c)=>{t.dispatch("ba-currency-own/setGetLatestBeforeMonthListener",{year:l,month:c,callback:y=>{const B=[];let b=[],I=0;o.value&&(b=Object.keys(o.value),b.reverse(),I=b.length);for(let k=0;k<I;k++){const C=o.value[b[k]];let x=o.value[b[k+1]];const R={date:b[k],pyroxene:C.pyroxene,free_pull:C.free_pull,diff_pyroxene:null,diff_free_pull:null};!x&&y&&(x=y[Object.keys(y)[0]]),x&&(R.diff_pyroxene=C.pyroxene-x.pyroxene,R.diff_free_pull=C.free_pull-x.free_pull),B.push(R)}_.value=B}})},M=(l,c)=>{t.dispatch("ba-currency-own/setGetRecordsListen",{year:l,month:c,callback:y=>{o.value=y,w(),T(l,c)}})},W=(l,c)=>{t.dispatch("ba-currency-use/setGetRecordsListen",{year:l,month:c,callback:y=>{i.value=y,w()}})},se=()=>{t.dispatch("ba-banner-pull/setGetUpcomingRecordsListen",l=>{t.commit("ba-banner-pull/setBannerPull",l)})},J=l=>{n.value=l,M(l.format("YYYY"),l.format("MM")),W(l.format("YYYY"),l.format("MM"))},ke=()=>{const l=n.value.add(-1,"month").startOf("month");J(l)},ae=()=>{const l=n.value.add(1,"month").startOf("month");J(l)},ne=async()=>{const l=N(p.day);let c={pyroxene:p.pyroxene,free_pull:p.free_pull};s.value==="record"?(isNaN(c.pyroxene)&&(c.pyroxene=u.value?u.value.pyroxene:0),isNaN(c.free_pull)&&(c.free_pull=u.value?u.value.free_pull:0),t.dispatch("ba-currency-own/save",{key:l.format("YYYY-MM-DD"),data:c})):s.value==="use"?(isNaN(c.pyroxene)&&isNaN(c.free_pull)||c.pyroxene<=0&&c.free_pull<=0?c=null:(isNaN(c.pyroxene)&&(c.pyroxene=0),isNaN(c.free_pull)&&(c.free_pull=0)),t.dispatch("ba-currency-use/save",{key:l.format("YYYY-MM-DD"),data:c})):console.error("Form Active Key is invalid."),p.pyroxene=void 0,p.free_pull=void 0,w()},w=()=>{const l=[],c=[],y=[],B=u.value?N(u.value.date):!1,b=t.state["ba-banner-pull"].banner_pull,I=Object.keys(b);let k=!1,C=!1;const x=[],R=n.value.startOf("month"),Te=n.value.endOf("month"),Ie=R.diff(Te,"day")*-1+1;for(let oe=0;oe<Ie;oe++){const F=R.add(oe,"day"),re=F.format("YYYY-MM-DD"),ie=o.value?o.value[re]:!1;let ve=null,we=null;if(ie&&(ve=Q({pyroxene:ie.pyroxene,free_pull:ie.free_pull})),B){const xe=B.diff(F,"day");xe<=0&&(k===!1?k=xe*-1*De+u.value.pyroxene:k+=De,b&&(C||(I.forEach(le=>{const V=b[le],U=N(V.date),ce=U.diff(B,"day"),ue=U.startOf("month"),de=F.startOf("month"),Fe=ue.diff(de,"month");ce>0&&Fe<0&&(k-=V.pull*120)}),C=!0),I.forEach(le=>{const V=b[le],U=N(V.date),ce=U.diff(B,"day"),ue=U.diff(F,"day"),de=U.diff(F,"month");ce>0&&de===0&&ue===0&&(k-=V.pull*120)})),we=Q({pyroxene:k,free_pull:u.value.free_pull}));const $e=vt(b,{date:re});$e.length<=0?x.push(null):x.push($e)}l.push(re),c.push(ve),y.push(we)}g.value.labels=l,g.value.data=[c,y],g.value.pull_banners=x};return ge(()=>{L(),se(),M(n.value.format("YYYY"),n.value.format("MM")),W(n.value.format("YYYY"),n.value.format("MM"))}),(l,c)=>(d(),f("div",Os,[r("div",Es,[r("div",Gs,[r("img",{src:h(Ts),class:"cursor-pointer select-none",onClick:ke},null,8,js),r("span",qs,$(n.value.format("YYYY-MM")),1),r("img",{src:h(Is),class:"cursor-pointer select-none",onClick:ae},null,8,Ks)]),r("div",zs,[r("div",Ws,[g.value.labels?(d(),Re(ms,{key:0,labels:g.value.labels,data:g.value.data,"pull-banners":g.value.pull_banners},null,8,["labels","data","pull-banners"])):H("",!0)])])]),m(E,{class:"max-h-72 col-span-full md:col-span-2"},{body:Y(()=>[Z(" TBD ")]),_:1}),m(E,{class:"max-h-72 col-span-full md:col-span-2","no-padding":""},{body:Y(()=>[r("div",Js,[r("ul",Zs,[(d(!0),f(z,null,be(a.value,y=>(d(),f("li",{key:y.key,class:"col-span-auto"},[r("div",{class:A(["p-3 border-b-2 border-transparent rounded-t-lg cursor-pointer",S(y)]),onClick:B=>te(y.key)},$(y.label),11,Qs)]))),128))])]),r("div",Xs,[r("div",ea,[m(j,{modelValue:p.day,"onUpdate:modelValue":c[0]||(c[0]=y=>p.day=y),icon:h(Fs),"icon-title":"Date",type:"date",danger:s.value==="use"},null,8,["modelValue","icon","danger"])]),r("div",ta,[m(j,{modelValue:p.pyroxene,"onUpdate:modelValue":c[1]||(c[1]=y=>p.pyroxene=y),modelModifiers:{number:!0},placeholder:s.value==="record"?u.value.pyroxene:"0",icon:h(pe),"icon-title":"Pyroxene",type:"number",danger:s.value==="use"},null,8,["modelValue","placeholder","icon","danger"])]),r("div",sa,[m(j,{modelValue:p.free_pull,"onUpdate:modelValue":c[2]||(c[2]=y=>p.free_pull=y),modelModifiers:{number:!0},placeholder:s.value==="record"?u.value.free_pull:"0",icon:h(ye),"icon-title":"Free Pull",type:"number",danger:s.value==="use"},null,8,["modelValue","placeholder","icon","danger"])]),r("div",aa,[m(Pe,{"on-click":ne,primary:s.value==="record",danger:s.value==="use"},{default:Y(()=>[Z(" Save ")]),_:1},8,["primary","danger"])])])]),_:1}),m(E,{class:"col-span-full md:col-span-4 xl:col-span-3"},{body:Y(()=>[na,m(Cs,{class:"max-h-56 overflow-auto pr-2",items:_.value,"currency-use":i.value},null,8,["items","currency-use"])]),_:1}),m(E,{class:"col-span-full overflow-auto md:col-span-4 xl:col-span-3"},{body:Y(()=>[oa,m(Ss,{class:"max-h-56 overflow-auto pr-2"})]),_:1}),r("div",ra,[r("div",ia,[r("img",{class:"inline-block max-w-36",src:h(Vs),title:"My Wife!!!"},null,8,la)])])]))}},ua=ot({history:rt(),routes:[{path:gt(""),component:Ft,children:[{path:"",component:ca}]}]});it(ht).use(Yt).use(ua).mount("#app");
