import{u as I,c as we,o as f,a as m,b as o,d as p,t as k,e as Y,g as ge,G as Ge,s as je,f as qe,h as U,i as ze,j as Ke,k as Q,l as We,r as Se,m as h,F as X,n as re,p as Je,q as Ze,v as Te,w as Qe,x as Xe,y as et,z as Ae,A as tt,B as st,D as nt,E as at,H as ot,I as rt,J as be,K as B,L as $,M as P,N as He,O as ke,P as Ie,Q as xe,R as $e,S as Pe,T as lt,U as it,V as ct}from"./vendor-BQVWAgHc.js";import{C as Ue}from"./chart.js-ddEKr6i1.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(a){if(a.ep)return;a.ep=!0;const r=n(a);fetch(a.href,r)}})();const ut="/gacha-tracker-online/assets/logo-QuR3q7Cb.png",dt={class:"w-full h-12 bg-white shadow md:px-4 sm:px-6 px-4 sticky top-0 z-10"},_t={class:"flex h-full items-center"},ft={class:"flex-none w-14"},mt=["src"],pt={class:"flex-1 flex justify-end items-center"},yt=["title"],ht={class:"w-20"},gt={__name:"Nav",setup(e){const t=I(),n=we(()=>t.state.user),s=()=>{const r=ge(),l=new Ge;je(r,l).then(d=>{}).catch(d=>{console.log(d)})},a=()=>{const r=ge();qe(r).then(l=>{}).catch(l=>{console.log(l)})};return(r,l)=>(f(),m("div",dt,[o("div",_t,[o("div",ft,[o("img",{src:p(ut)},null,8,mt)]),o("div",pt,[n.value?(f(),m("span",{key:0,class:"mr-3 truncate max-w-52",title:n.value.ign},k(n.value.ign),9,yt)):Y("",!0),o("div",ht,[n.value?(f(),m("button",{key:1,onClick:a,class:"bg-white w-full p-1 border rounded-lg"},"Sign Out")):(f(),m("button",{key:0,onClick:s,class:"bg-white w-full p-1 border rounded-lg"},"Sign In"))])])])]))}},bt={__name:"App",setup(e){U.extend(ze);const t=I(),s=Ke({apiKey:"AIzaSyB8hRY_mV19i_4K-Mno7Sn8FpOJGEIvDKM",authDomain:"gacha-tracker-online.firebaseapp.com",projectId:"gacha-tracker-online",storageBucket:"gacha-tracker-online.appspot.com",messagingSenderId:"395636017581",appId:"1:395636017581:web:2f03e7f80569c9a537b924",measurementId:"G-HW1B3NSFH8",databaseURL:"https://gacha-tracker-online-default-rtdb.asia-southeast1.firebasedatabase.app/"}),a=ge(s);return Q(s),We(s),a.onAuthStateChanged(async r=>{if(!r&&t.state.user)window.location.reload();else if(!r)t.commit("setUser",!1);else{t.commit("setUID",r.uid);let l={};const d=U.utc().format("YYYY-MM-DD HH:mm:ss");t.dispatch("setUserListen",_=>{t.state.user||(_?(l={..._},l.last_signed_in_at=d):l={ign:"",active:!1,created_at:d,last_signed_in_at:d},t.dispatch("saveUser",l)),_&&t.commit("setUser",_)})}}),(r,l)=>{const d=Se("router-view");return f(),m(X,null,[h(gt),h(d)],64)}}},kt=e=>(e&&e[0]==="/"&&(e=e.substring(1)),`/gacha-tracker-online/${e||""}`),vt=(e,t)=>{let n=-1;const s=Object.keys(t);return e.forEach((a,r)=>{const l=[];if(s.forEach(d=>{a[d]===t[d]&&l.push(!0)}),l.length===s.length)return n=r,r}),n},wt=(e,t)=>e.filter(n=>{let s=[];for(let a in t)s.push(t[a]===n[a]);return s.every(a=>a)}),xt=(e,t)=>{const n=[];for(let s in e)n.push(e[s]);return wt(n,t)},Fe=(e,t)=>{const n=vt(e,t);return n>-1?e[n]:!1},S=e=>U(`${e} 00:00:00`),T=({pyroxene:e,free_pull:t})=>Math.floor(e/120)+t,$t=e=>Math.floor(e/200),C=e=>new Intl.NumberFormat("en-US",{}).format(e),Bt=async e=>{const t=Q();try{const s=(await Ze(Je(re(t),e))).val();return s||!1}catch(n){console.error(n)}},Lt=(e,t)=>{const n=Q(),s=re(n,e);Te(s,a=>{const r=a.val();t(r)})},Z=(e,t)=>{const n=Q();Qe(re(n,e),t)},K=(e,t,n={})=>{n.filters||(n.filters=[]);const s=Q(),a=[];let r=null;switch(n.order){case"child":a.push(et(n.order_key));break;case"key":a.push(Xe());break;case"value":a.push(orderByValue(n.order_key));break}n.filters.forEach(l=>{switch(l.type){case"first":a.push(at(l.value));break;case"last":a.push(nt(l.value));break;case"between":n.order==="key"&&(a.push(Ae(l.start)),a.push(st(l.end)));break;case"endBefore":n.order==="key"&&a.push(tt(l.value));break;case"startAt":n.order==="key"&&a.push(Ae(l.value));break}}),r=ot(re(s,e),...a),Te(r,l=>t(l.val()))},Ct={namespaced:!0,state:{DB_PATH_BA_BANNER_PULL:"/ba-banner-pull",banner_pull:!1,listGetUpcomingListener:!1},mutations:{setBannerPull(e,t){e.banner_pull=t?{...t}:!1}},getters:{find:e=>t=>{const n=e.banner_pull[t];return n||null}},actions:{save({state:e,rootState:t},{key:n,data:s}){Z(`${e.DB_PATH_BA_BANNER_PULL}/${t.uid}/${n}`,s)},delete({state:e,rootState:t},n){Z(`${e.DB_PATH_BA_BANNER_PULL}/${t.uid}/${n}`,null)},setGetUpcomingRecordsListen({state:e,rootState:t},n){const{listGetUpcomingListener:s}=e;s&&(s.off(),e.listGetUpcomingListener=!1),e.listLatestListener=K(`${e.DB_PATH_BA_BANNER_PULL}/${t.uid}`,n,{order:"key",filters:[{type:"startAt",value:"2023-12-00"}]})}}},Yt={namespaced:!0,state:{DB_PATH_BA_CURRENCY_OWN:"/ba-currency-own",listGetListener:!1,listLatestListener:!1,listLatestBeforeMonthListener:!1},actions:{save({state:e,rootState:t},{key:n,data:s}){Z(`${e.DB_PATH_BA_CURRENCY_OWN}/${t.uid}/${n}`,s)},setGetRecordsListen({state:e,rootState:t},{year:n,month:s,callback:a}){const{listGetListener:r}=e;r&&(r.off(),e.listGetListener=!1),e.listLatestListener=K(`${e.DB_PATH_BA_CURRENCY_OWN}/${t.uid}`,a,{order:"key",filters:[{type:"between",start:`${n}-${s}-00`,end:`${n}-${s}-99`}]})},setGetLatestRecordListen({state:e,rootState:t},n){const{listLatestListener:s}=e;s&&(s.off(),e.listLatestListener=!1),e.listLatestListener=K(`${e.DB_PATH_BA_CURRENCY_OWN}/${t.uid}`,n,{filters:[{type:"last",value:1}]})},setGetLatestBeforeMonthListener({state:e,rootState:t},{year:n,month:s,callback:a}){const{listLatestBeforeMonthListener:r}=e;r&&(r.off(),e.listLatestBeforeMonthListener=!1),e.listLatestBeforeMonthListener=K(`${e.DB_PATH_BA_CURRENCY_OWN}/${t.uid}`,a,{order:"key",filters:[{type:"endBefore",value:`${n}-${s}-00`},{type:"last",value:1}]})}}},Mt={namespaced:!0,state:{DB_PATH_BA_CURRENCY_USE:"/ba-currency-use",listGetListener:!1},actions:{save({state:e,rootState:t},{key:n,data:s}){Z(`${e.DB_PATH_BA_CURRENCY_USE}/${t.uid}/${n}`,s)},setGetRecordsListen({state:e,rootState:t},{year:n,month:s,callback:a}){const{listGetListener:r}=e;r&&(r.off(),e.listGetListener=!1),e.listLatestListener=K(`${e.DB_PATH_BA_CURRENCY_USE}/${t.uid}`,a,{order:"key",filters:[{type:"between",start:`${n}-${s}-00`,end:`${n}-${s}-99`}]})}}},Dt={"ba-banner-pull":Ct,"ba-currency-own":Yt,"ba-currency-use":Mt},At=rt({state:{DB_PATH_USER:"/users",DB_PATH_BLUE_ARCHIVE_CURRENCY:"/blue-archive-currencies",user:!1,uid:!1},mutations:{setUser(e,t){e.user=t?{...t}:!1},setUID(e,t){e.uid=t||!1}},actions:{findUser({state:e}){return Bt(`${e.DB_PATH_USER}/${e.uid}`)},setUserListen({state:e},t){Lt(`${e.DB_PATH_USER}/${e.uid}`,n=>t(n))},async saveUser({state:e},t){await Z(`${e.DB_PATH_USER}/${e.uid}`,t)}},modules:Dt}),Pt={class:"relative shadow bg-white rounded-sm"},z={__name:"Card",props:{noPadding:{type:Boolean,default:!1}},setup(e){return(t,n)=>(f(),m("div",Pt,[be(t.$slots,"cover"),o("div",{class:B({"p-3":!e.noPadding})},[be(t.$slots,"body")],2)]))}},Ut=(e,t)=>{const n=e.__vccOpts||e;for(const[s,a]of t)n[s]=a;return n},Nt={class:"relative"},Rt=["src","title"],St=["placeholder","type","value"],Tt={__name:"Base",props:{danger:{type:Boolean,default:!1},icon:{},iconTitle:{},modelValue:{},type:{default:"text"},placeholder:{default:""},onChange:{type:Function,default(){return()=>{}}}},emits:["update:modelValue"],setup(e){const t=e,n=()=>{const{danger:s}=t;return s?["border-danger"]:["border-primary"]};return(s,a)=>(f(),m("div",Nt,[e.icon?(f(),m("img",{key:0,class:"absolute w-8 max-h-5 inset-y-0 m-auto z-10",src:e.icon,title:e.iconTitle},null,8,Rt)):Y("",!0),o("input",{class:B(["w-full h-7 border-2 drop-shadow-sm focus:outline-0",[{"pl-4":!e.icon,"pl-9":e.icon},n()]]),placeholder:e.placeholder,type:e.type,value:e.modelValue,onInput:a[0]||(a[0]=r=>s.$emit("update:modelValue",r.target.value)),onChange:a[1]||(a[1]=(...r)=>e.onChange&&e.onChange(...r))},null,42,St)]))}},W=Ut(Tt,[["__scopeId","data-v-1d9c3069"]]),Ee={__name:"Base",props:{primary:Boolean,danger:Boolean,onClick:Function},setup(e){const t=e,n=()=>({"border-2":!t.primary&&!t.danger,"text-white":t.primary||t.danger,"bg-primary":t.primary,"bg-danger":t.danger});return(s,a)=>(f(),m("button",{class:B(["rounded w-full h-8 select-none",[n()]]),onClick:a[0]||(a[0]=(...r)=>e.onClick&&e.onClick(...r))},[be(s.$slots,"default")],2))}},Ht={class:"w-full py-3 md:px-8 sm:px-6 px-4"},It={key:0},Ft={class:"grid grid-cols-2 gap-4"},Et={class:"col-span-full md:col-span-1"},Ot={key:1},Vt={__name:"Main",setup(e){const t=I(),n=we(()=>t.state.user),s=$(""),a=()=>{const{user:r}=t.state;r.ign=s,t.dispatch("saveUser",r)};return(r,l)=>{const d=Se("router-view");return f(),m("div",Ht,[n.value?(f(),m(X,{key:0},[n.value.ign?n.value.active?(f(),He(d,{key:2})):(f(),m("div",Ot,"Please contact Minnerva to activate your account.")):(f(),m("div",It,[h(z,null,{body:P(()=>[o("div",Ft,[o("label",Et,[ke(" Input your IGN or Discord Name: "),h(W,{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=_=>s.value=_)},null,8,["modelValue"])]),h(Ee,{class:"col-span-full md:col-start-1 md:col-end-2","on-click":a,primary:""},{default:P(()=>[ke("Submit")]),_:1})])]),_:1})]))],64)):Y("",!0)])}}},Gt="/gacha-tracker-online/assets/akane-bunny-icon-gfOjhgOr.webp",jt="/gacha-tracker-online/assets/asuna-bunny-icon-oF1effRe.webp",qt="/gacha-tracker-online/assets/hanako-swimsuit-icon-s2k28dzI.webp",zt="/gacha-tracker-online/assets/hare-camping-icon-xHKeVTgU.webp",Kt="/gacha-tracker-online/assets/haruna-tracksuit-icon-C3yJc6jX.webp",Wt="/gacha-tracker-online/assets/himari-icon-NnOzyjRg.webp",Jt="/gacha-tracker-online/assets/hina-swimsuit-icon-3-IoiTOU.webp",Zt="/gacha-tracker-online/assets/hinata-swimsuit-icon-Vx2yAU8s.webp",Qt="/gacha-tracker-online/assets/iori-swimsuit-icon-5HfIKnaa.webp",Xt="/gacha-tracker-online/assets/karin-bunny-icon-z90yfVlX.webp",es="/gacha-tracker-online/assets/kayoko-new-year-icon-lEZ08tqZ.webp",ts="/gacha-tracker-online/assets/kikyou-icon-OCtBoToh.webp",ss="/gacha-tracker-online/assets/kotama-camping-icon-j0Rln9bx.webp",ns="/gacha-tracker-online/assets/mari-tracksuit-icon-IfCWZ2Vl.webp",as="/gacha-tracker-online/assets/mimori-swimsuit-icon-ICDRkuj4.webp",os="/gacha-tracker-online/assets/misaka-mikoto-icon-t-m5DYfT.webp",rs="/gacha-tracker-online/assets/miyako-swimsuit-icon-9NTUwO2x.webp",ls="/gacha-tracker-online/assets/neru-bunny-icon-QPIKLGG6.webp",is="/gacha-tracker-online/assets/nonomi-swimsuit-icon-Yyj40vp2.webp",cs="/gacha-tracker-online/assets/renge-icon-nMq9xxcQ.webp",us="/gacha-tracker-online/assets/saki-swimsuit-icon-y07xpALf.webp",ds="/gacha-tracker-online/assets/shiroko-swimsuit-icon-gmc76iBJ.webp",_s="/gacha-tracker-online/assets/shokuhou-misaki-icon-r8ShdIbR.webp",fs="/gacha-tracker-online/assets/ui-swimsuit-icon-Y8SkXBci.webp",ms="/gacha-tracker-online/assets/wakamo-swimsuit-icon-aFL8264u.webp",ps="/gacha-tracker-online/assets/yukari-icon-lJbTFHeZ.webp",ys="/gacha-tracker-online/assets/yuuka-tracksuit-icon-obYhk5gg.webp";let ve=[{name:"Akane",alter:"Bunny"},{name:"Asuna",alter:"Bunny"},{name:"Hanako",alter:"Swimsuit"},{name:"Hare",alter:"Camping"},{name:"Haruna",alter:"Tracksuit"},{name:"Himari",alter:""},{name:"Hina",alter:"Swimsuit"},{name:"Hinata",alter:"Swimsuit"},{name:"Iori",alter:"Swimsuit"},{name:"Karin",alter:"Bunny"},{name:"Kayoko",alter:"New Year"},{name:"Kikyou",alter:""},{name:"Kotama",alter:"Camping"},{name:"Mari",alter:"Tracksuit"},{name:"Mimori",alter:"Swimsuit"},{name:"Misaka Mikoto",alter:""},{name:"Miyako",alter:"Swimsuit"},{name:"Neru",alter:"Bunny"},{name:"Nonomi",alter:"Swimsuit"},{name:"Renge",alter:""},{name:"Saki",alter:"Swimsuit"},{name:"Shiroko",alter:"Swimsuit"},{name:"Shokuhou Misaki",alter:""},{name:"Ui",alter:"Swimsuit"},{name:"Wakamo",alter:"Swimsuit"},{name:"Yukari",alter:""},{name:"Yuuka",alter:"Tracksuit"}];ve=ve.map(e=>(e.full_name=e.alter?`${e.name} (${e.alter})`:e.name,e.key=e.full_name.replace(/[()]/g,"").replace(/\s/g,"-").toLocaleLowerCase(),e.icon=new URL(Object.assign({"/src/assets/students/akane-bunny-icon.webp":Gt,"/src/assets/students/asuna-bunny-icon.webp":jt,"/src/assets/students/hanako-swimsuit-icon.webp":qt,"/src/assets/students/hare-camping-icon.webp":zt,"/src/assets/students/haruna-tracksuit-icon.webp":Kt,"/src/assets/students/himari-icon.webp":Wt,"/src/assets/students/hina-swimsuit-icon.webp":Jt,"/src/assets/students/hinata-swimsuit-icon.webp":Zt,"/src/assets/students/iori-swimsuit-icon.webp":Qt,"/src/assets/students/karin-bunny-icon.webp":Xt,"/src/assets/students/kayoko-new-year-icon.webp":es,"/src/assets/students/kikyou-icon.webp":ts,"/src/assets/students/kotama-camping-icon.webp":ss,"/src/assets/students/mari-tracksuit-icon.webp":ns,"/src/assets/students/mimori-swimsuit-icon.webp":as,"/src/assets/students/misaka-mikoto-icon.webp":os,"/src/assets/students/miyako-swimsuit-icon.webp":rs,"/src/assets/students/neru-bunny-icon.webp":ls,"/src/assets/students/nonomi-swimsuit-icon.webp":is,"/src/assets/students/renge-icon.webp":cs,"/src/assets/students/saki-swimsuit-icon.webp":us,"/src/assets/students/shiroko-swimsuit-icon.webp":ds,"/src/assets/students/shokuhou-misaki-icon.webp":_s,"/src/assets/students/ui-swimsuit-icon.webp":fs,"/src/assets/students/wakamo-swimsuit-icon.webp":ms,"/src/assets/students/yukari-icon.webp":ps,"/src/assets/students/yuuka-tracksuit-icon.webp":ys})[`/src/assets/students/${e.key}-icon.webp`],import.meta.url).href,e));const Oe=ve,Ne="chart",hs={__name:"LineChart",props:{labels:{type:Array,required:!0},data:{type:Array,required:!0},pullBanners:{type:Array,default(){return[]}}},setup(e,{expose:t}){const n=e;let s=null;const a={};Ie(n,()=>{r()}),Ue.register({id:"default",afterDatasetsDraw(d){const _=d.getDatasetMeta(0).data;if(_.length>0){const{ctx:i}=d,g=14*d.currentDevicePixelRatio,x=16*d.currentDevicePixelRatio;_.forEach(({$context:le},M)=>{const F=d.getDatasetMeta(1).data[M],E=le.raw,O=F.$context.raw;if((E||O)&&n.pullBanners[M]){const ee=E?_[M].x:F.x,te=E?_[M].y:F.y;n.pullBanners[M].forEach((se,ie)=>{const D=Fe(Oe,{key:se.student_key});if(D){if(!a[D.key]){const ne=new Image(g,x);ne.src=D.icon,a[D.key]=ne}i.drawImage(a[D.key],ee-g/2,te-(-10+ie*-1*x),g,x)}})}})}}});const r=()=>{s.data.labels=n.labels,n.data.forEach((d,_)=>{s.data.datasets[_].data=d}),s.update()},l=()=>{s=new Ue(document.querySelector(`#${Ne}`),{type:"line",data:{labels:[],datasets:[{label:"Record",data:[],borderColor:"#00D8FB",backgroundColor:"#FFFFFF"},{label:"Estimate",data:[],borderColor:"#FFE9F2",backgroundColor:"#FFFFFF"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{},animation:{},scales:{x:{ticks:{autoSkip:!0,maxTicksLimit:6}},y:{beginAtZero:!0,ticks:{stepSize:100,color:d=>d.tick.value<0?"red":""},grid:{color:d=>d.tick.value<=0?"red":""}}}}})};return xe(()=>{l()}),t({updateChart:r}),(d,_)=>(f(),m("canvas",{id:Ne}))}},gs={class:"flex items-center"},bs=["src","title"],q={__name:"HistorySub",props:{icon:{required:!0},iconTitle:{},own:{required:!0},diff:{},danger:{type:Boolean,default:!1}},setup(e){const t=s=>{if(s>0)return"text-success";if(s<0)return"text-danger"},n=s=>`(${s>=0?"+":""}${C(s)})`;return(s,a)=>(f(),m("div",gs,[o("img",{class:"w-8 mr-2",src:e.icon,title:e.iconTitle},null,8,bs),o("span",{class:B({"text-danger":e.danger})},k(p(C)(e.own)),3),e.diff&&e.diff!==0?(f(),m("span",{key:0,class:B(["ml-1 text-xs",t(e.diff)])},k(n(e.diff)),3)):Y("",!0)]))}},H="/gacha-tracker-online/assets/pyroxene-gBHgCIjf.webp",J="/gacha-tracker-online/assets/recruitment-ticket-NiO_EDI9.webp",Be="/gacha-tracker-online/assets/icon-pulls-PmRtrI9p.png",ks="/gacha-tracker-online/assets/icon-3-stars-unit-G8a83jjO.png",vs={class:"grid grid-cols-2 gap-3"},ws={class:"col-span-1 border-r"},xs=o("div",{class:"text-center text-xs pb-2"},"Record",-1),$s={key:0,class:"col-span-1"},Bs=o("div",{class:"text-center text-xs pb-2"},"Use",-1),Ls={class:"col-span-full flex justify-center"},Cs={__name:"History",props:{item:{required:!0},use:{default:!1}},setup(e){const t=$(U()),n=s=>s===t.value.format("YYYY-MM-DD")?["text-primary","font-bold"]:[];return(s,a)=>(f(),m("div",vs,[o("div",{class:B(["col-span-2",n(e.item.date)])},k(e.item.date),3),o("div",ws,[xs,h(q,{icon:p(H),"icon-title":"Pyroxene",own:e.item.pyroxene,diff:e.item.diff_pyroxene},null,8,["icon","own","diff"]),h(q,{icon:p(J),"icon-title":"Pull Ticket",own:e.item.free_pull,diff:e.item.diff_free_pull},null,8,["icon","own","diff"])]),e.use?(f(),m("div",$s,[Bs,h(q,{icon:p(H),"icon-title":"Pyroxene",own:e.use.pyroxene,danger:""},null,8,["icon","own"]),h(q,{icon:p(J),"icon-title":"Pull Ticket",own:e.use.free_pull,danger:""},null,8,["icon","own"])])):Y("",!0),o("div",Ls,[h(q,{icon:p(Be),"icon-title":"Total Pull",own:p(T)(e.item),diff:p(T)({pyroxene:e.item.diff_pyroxene,free_pull:e.item.diff_free_pull})},null,8,["icon","own","diff"])])]))}},Ys={class:"flow-root"},Ms={class:"divide-y divide-gray-200 dark:divide-gray-700"},Ds={key:0,class:"py-3 sm:py-4"},As={__name:"History",props:{items:{required:!0},currencyUse:{default(){return{}}}},setup(e){return(t,n)=>(f(),m("div",Ys,[o("ul",Ms,[!e.items||e.items.length<=0?(f(),m("li",Ds,"No record found.")):(f(!0),m(X,{key:1},$e(e.items,s=>(f(),m("li",{key:s.date,class:"py-3 sm:py-4"},[h(Cs,{item:s,use:e.currencyUse?e.currencyUse[s.date]:null},null,8,["item","use"])]))),128))])]))}};let oe=[{date:"2023-09-26",duration:7,student_key:"kayoko-new-year"},{date:"2024-01-09",duration:7,student_key:"hina-swimsuit"},{date:"2024-01-09",duration:7,student_key:"iori-swimsuit"},{date:"2023-12-26",duration:14,student_key:"miyako-swimsuit"},{date:"2023-12-26",duration:14,student_key:"saki-swimsuit"},{date:"2024-01-16",duration:7,student_key:"shiroko-swimsuit"},{date:"2024-01-16",duration:7,student_key:"nonomi-swimsuit"},{date:"2024-01-16",duration:7,student_key:"wakamo-swimsuit"},{date:"2024-01-23",duration:9,student_key:"ui-swimsuit"},{date:"2024-01-23",duration:9,student_key:"hinata-swimsuit"},{date:"2024-02-01",duration:7,student_key:"hanako-swimsuit"},{date:"2024-02-15",duration:7,student_key:"mimori-swimsuit"},{date:"2024-03-16",duration:12,student_key:"haruna-tracksuit"},{date:"2024-03-16",duration:12,student_key:"yuuka-tracksuit"},{date:"2024-03-16",duration:12,student_key:"mari-tracksuit"},{date:"2024-04-18",duration:14,student_key:"misaka-mikoto"},{date:"2024-04-18",duration:14,student_key:"shokuhou-misaki"},{date:"2024-05-02",duration:8,student_key:"yukari"},{date:"2024-05-16",duration:14,student_key:"renge"},{date:"2024-05-16",duration:14,student_key:"kikyou"},{date:"2024-05-30",duration:7,student_key:"himari"},{date:"2024-06-13",duration:7,student_key:"karin-bunny"},{date:"2024-06-13",duration:7,student_key:"neru-bunny"},{date:"2024-06-13",duration:7,student_key:"akane-bunny"},{date:"2024-06-13",duration:7,student_key:"asuna-bunny"},{date:"2024-06-20",duration:14,student_key:"hare-camping"},{date:"2024-06-20",duration:14,student_key:"kotama-camping"}];oe=oe.map(e=>(e.key=`${e.date}-${e.student_key}`,e));oe.sort((e,t)=>e.date>t.date?1:e.date<t.date?-1:0);const Ps=oe,Us={class:"grid grid-cols-10 gap-3 md:items-center"},Ns={class:"col-span-2 lg:col-span-2"},Rs=["src","title"],Ss={class:"col-span-8 lg:col-span-8"},Ts={__name:"Banner",props:{item:{required:!0},bannerPull:{}},setup(e){const t=e,n=I(),s=$(null),a=Fe(Oe,{key:t.item.student_key});Ie(t,()=>{r()});const r=()=>{const _=n.getters["ba-banner-pull/find"](t.item.key);s.value=_?_.pull:null},l=()=>t.item.diff<=0?" - Live":` - ${t.item.diff} days`,d=()=>{const{item:_}=t,i=_.key;!s.value||s.value<=0?(n.dispatch("ba-banner-pull/delete",i),s.value=null):n.dispatch("ba-banner-pull/save",{key:i,data:{date:_.date,student_key:_.student_key,pull:s.value}})};return xe(()=>{r()}),(_,i)=>(f(),m("div",Us,[o("div",Ns,[o("img",{src:p(a).icon,title:p(a).full_name},null,8,Rs)]),o("div",Ss,[o("div",null,k(e.item.date)+k(l()),1),o("div",null,k(p(a).full_name),1),o("div",null,[h(W,{modelValue:s.value,"onUpdate:modelValue":i[0]||(i[0]=g=>s.value=g),modelModifiers:{number:!0},placeholder:"200",icon:p(Be),"icon-title":"Pull",type:"number","on-change":d},null,8,["modelValue","icon"])])])]))}},Hs={class:"flow-root"},Is={class:"divide-y divide-gray-200 dark:divide-gray-700"},Fs={key:0,class:"py-3 sm:py-4"},Es={__name:"Banner",setup(e){const t=I(),n=we(()=>t.state["ba-banner-pull"].banner_pull),s=S(U().format("YYYY-MM-DD")),a=Ps.map(r=>{const l=S(r.date);return r.diff=l.diff(s,"day"),r}).filter(r=>r.diff>r.duration*-1);return(r,l)=>(f(),m("div",Hs,[o("ul",Is,[p(a).length<=0?(f(),m("li",Fs,"No banner found.")):(f(!0),m(X,{key:1},$e(p(a),d=>(f(),m("li",{key:d.key,class:"py-3 sm:py-4"},[h(Ts,{item:d,"banner-pull":n.value[d.key]},null,8,["item","banner-pull"])]))),128))])]))}},Os="data:image/svg+xml,%3c!--%20https://fontawesome.com/icons/chevron-left?f=classic&s=solid%20--%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='16'%20width='10'%20viewBox='0%200%20320%20512'%3e%3c!--!Font%20Awesome%20Free%206.5.1%20by%20@fontawesome%20-%20https://fontawesome.com%20License%20-%20https://fontawesome.com/license/free%20Copyright%202023%20Fonticons,%20Inc.--%3e%3cpath%20d='M9.4%20233.4c-12.5%2012.5-12.5%2032.8%200%2045.3l192%20192c12.5%2012.5%2032.8%2012.5%2045.3%200s12.5-32.8%200-45.3L77.3%20256%20246.6%2086.6c12.5-12.5%2012.5-32.8%200-45.3s-32.8-12.5-45.3%200l-192%20192z'/%3e%3c/svg%3e",Vs="data:image/svg+xml,%3c!--%20https://fontawesome.com/icons/chevron-right?f=classic&s=solid%20--%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='16'%20width='10'%20viewBox='0%200%20320%20512'%3e%3c!--!Font%20Awesome%20Free%206.5.1%20by%20@fontawesome%20-%20https://fontawesome.com%20License%20-%20https://fontawesome.com/license/free%20Copyright%202023%20Fonticons,%20Inc.--%3e%3cpath%20d='M310.6%20233.4c12.5%2012.5%2012.5%2032.8%200%2045.3l-192%20192c-12.5%2012.5-32.8%2012.5-45.3%200s-12.5-32.8%200-45.3L242.7%20256%2073.4%2086.6c-12.5-12.5-12.5-32.8%200-45.3s32.8-12.5%2045.3%200l192%20192z'/%3e%3c/svg%3e",Gs="data:image/svg+xml,%3c!--%20https://fontawesome.com/icons/calendar?f=classic&s=regular&pc=%252300d8fb%20--%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='16'%20width='14'%20viewBox='0%200%20448%20512'%3e%3c!--!Font%20Awesome%20Free%206.5.1%20by%20@fontawesome%20-%20https://fontawesome.com%20License%20-%20https://fontawesome.com/license/free%20Copyright%202023%20Fonticons,%20Inc.--%3e%3cpath%20fill='%2300d8fb'%20d='M152%2024c0-13.3-10.7-24-24-24s-24%2010.7-24%2024V64H64C28.7%2064%200%2092.7%200%20128v16%2048V448c0%2035.3%2028.7%2064%2064%2064H384c35.3%200%2064-28.7%2064-64V192%20144%20128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24%2010.7-24%2024V64H152V24zM48%20192H400V448c0%208.8-7.2%2016-16%2016H64c-8.8%200-16-7.2-16-16V192z'/%3e%3c/svg%3e",js="/gacha-tracker-online/assets/mika-portrait-iOc64siT.webp",qs={class:"grid grid-cols-10 gap-4"},zs={class:"col-span-full md:col-span-7 xl:col-span-8"},Ks={class:"flex justify-center text-center"},Ws=["src"],Js={class:"mx-4 text-xl md:text-3xl font-bold"},Zs=["src"],Qs={class:"flex justify-center"},Xs={class:"w-full h-72"},en=o("div",{class:"h-10 text-md0 md:text-xl font-bold border-b"},"Summary",-1),tn={class:"grid grid-cols-2 gap-3 mt-3"},sn={class:"col-span-1 flex items-center"},nn=["src"],an={class:"col-span-1 flex items-center"},on=["src"],rn={class:"col-span-1 flex items-center"},ln=["src"],cn={class:"col-span-1 flex items-center"},un=["src"],dn=o("div",{class:"col-span-full"},[o("div",{class:"h-10 flex items-center text-sm font-bold border-y"},"This Month - Total Earned In Pyroxene")],-1),_n={class:"col-span-1 flex items-center"},fn=["src"],mn={key:0},pn={key:1},yn=o("div",{class:"col-span-full"},[o("div",{class:"h-10 flex items-center text-sm font-bold border-y"},"This Month - Total Used")],-1),hn={class:"col-span-1 flex items-center"},gn=["src"],bn={class:"col-span-1 flex items-center"},kn=["src"],vn={class:"text-sm font-medium text-center text-gray-500 border-b border-gray-200 dark:text-gray-400 dark:border-gray-700"},wn={class:"grid grid-cols-2 gap-0"},xn=["onClick"],$n={class:"grid grid-cols-4 gap-4 p-3"},Bn={class:"col-span-full"},Ln={class:"col-span-full"},Cn={class:"col-span-full"},Yn={class:"col-span-full md:col-start-2 md:col-end-4 mt-4"},Mn=o("div",{class:"h-10 text-md0 md:text-xl font-bold border-b"},"History",-1),Dn=o("div",{class:"h-10 text-md0 md:text-xl font-bold border-b"},"Upcoming Banners",-1),An={class:"col-span-full md:col-span-full xl:col-span-2 grid items-center content-end"},Pn={class:"text-center"},Un=["src"],Re=12e3/30,Nn={__name:"Index",setup(e){const t=I(),n=$([{key:"record",label:"Record"},{key:"use",label:"Use"}]),s=$("record"),a=$(U()),r=$([]),l=$({}),d=$([]),_=$({date:"",pyroxene:0,free_pull:0}),i=Pe({current:{pyroxene:0,free_pull:0,total_pull:0,spark:0},monthly:{total_earn:0,use_pyroxene:0,use_free_pull:0}}),g=Pe({day:a.value.format("YYYY-MM-DD"),pyroxene:void 0,free_pull:void 0}),x=$({labels:[],data:[],pull_banners:[]}),le=c=>{if(c.key!==s.value)return["hover:text-gray-600","hover:border-gray-300","dark:hover:text-gray-300"];if(c.key==="record")return["font-bold","border-primary","text-primary"];if(c.key==="use")return["font-bold","border-danger","text-danger"]},M=c=>{s.value!==c&&(g.day=U().format("YYYY-MM-DD"),g.pyroxene=void 0,g.free_pull=void 0,s.value=c)},F=()=>{t.dispatch("ba-currency-own/setGetLatestRecordListen",c=>{if(c){const u=Object.keys(c);if(u.length>0){const y=u[0],b=c[y];_.value={date:y,...b},i.current={pyroxene:C(b.pyroxene),free_pull:C(b.free_pull)},i.current.total_pull=C(T(b)),i.current.spark=C($t(T(b)))}}})},E=(c,u)=>{t.dispatch("ba-currency-own/setGetLatestBeforeMonthListener",{year:c,month:u,callback:y=>{const b=[];let v=[],V=0;r.value&&(v=Object.keys(r.value),v.reverse(),V=v.length);for(let w=0;w<V;w++){const A=r.value[v[w]];let L=r.value[v[w+1]];const N={date:v[w],pyroxene:A.pyroxene,free_pull:A.free_pull,diff_pyroxene:null,diff_free_pull:null};if(!L&&y&&(L=y[Object.keys(y)[0]]),L){const ce=A.pyroxene-L.pyroxene,ue=A.free_pull-L.free_pull;N.diff_pyroxene=ce,N.diff_free_pull=ue}b.push(N)}d.value=b,O()}})},O=()=>{let c=0;if(d.value.length>0&&l.value){i.monthly.total_earn=0,i.monthly.use_pyroxene=0,i.monthly.use_free_pull=0;for(let b in l.value){const v=l.value[b];i.monthly.use_pyroxene+=v.pyroxene,i.monthly.use_free_pull+=v.free_pull}let u=0,y=0;d.value.forEach(b=>{u+=b.diff_pyroxene,y+=b.diff_free_pull}),c=u+y*120,c+=i.monthly.use_pyroxene+i.monthly.use_free_pull*120}i.monthly.total_earn=c,i.monthly.use_pyroxene=i.monthly.use_pyroxene&&!isNaN(i.monthly.use_pyroxene)?`-${C(i.monthly.use_pyroxene)}`:"-",i.monthly.use_free_pull=i.monthly.use_free_pull&&!isNaN(i.monthly.use_free_pull)?`-${C(i.monthly.use_free_pull)}`:"-"},ee=(c,u)=>{t.dispatch("ba-currency-own/setGetRecordsListen",{year:c,month:u,callback:y=>{r.value=y,ae(),E(c,u),O()}})},te=(c,u)=>{t.dispatch("ba-currency-use/setGetRecordsListen",{year:c,month:u,callback:y=>{l.value=y,ae(),O()}})},Le=()=>{t.dispatch("ba-banner-pull/setGetUpcomingRecordsListen",c=>{t.commit("ba-banner-pull/setBannerPull",c),ae()})},se=c=>{a.value=c,ee(c.format("YYYY"),c.format("MM")),te(c.format("YYYY"),c.format("MM"))},ie=()=>{const c=a.value.add(-1,"month").startOf("month");se(c)},D=()=>{const c=a.value.add(1,"month").startOf("month");se(c)},ne=async()=>{const c=S(g.day);let u={pyroxene:g.pyroxene,free_pull:g.free_pull};s.value==="record"?(isNaN(u.pyroxene)&&(u.pyroxene=_.value?_.value.pyroxene:0),isNaN(u.free_pull)&&(u.free_pull=_.value?_.value.free_pull:0),t.dispatch("ba-currency-own/save",{key:c.format("YYYY-MM-DD"),data:u})):s.value==="use"?(isNaN(u.pyroxene)&&isNaN(u.free_pull)||u.pyroxene<=0&&u.free_pull<=0?u=null:(isNaN(u.pyroxene)&&(u.pyroxene=0),isNaN(u.free_pull)&&(u.free_pull=0)),t.dispatch("ba-currency-use/save",{key:c.format("YYYY-MM-DD"),data:u})):console.error("Form Active Key is invalid."),g.pyroxene=void 0,g.free_pull=void 0,ae()},ae=()=>{const c=[],u=[],y=[],b=_.value?S(_.value.date):!1,v=t.state["ba-banner-pull"].banner_pull,V=Object.keys(v);let w=!1,A=!1;const L=[],N=a.value.startOf("month"),ce=a.value.endOf("month"),ue=N.diff(ce,"day")*-1+1;for(let de=0;de<ue;de++){const G=N.add(de,"day"),_e=G.format("YYYY-MM-DD"),fe=r.value?r.value[_e]:!1;let Ce=null,Ye=null;if(fe&&(Ce=T({pyroxene:fe.pyroxene,free_pull:fe.free_pull})),b){const Me=b.diff(G,"day");Me<=0&&(w===!1?w=Me*-1*Re+_.value.pyroxene:w+=Re,v&&(A||(V.forEach(me=>{const j=v[me],R=S(j.date),pe=R.diff(b,"day"),ye=R.startOf("month"),he=G.startOf("month"),Ve=ye.diff(he,"month");pe>0&&Ve<0&&(w-=j.pull*120)}),A=!0),V.forEach(me=>{const j=v[me],R=S(j.date),pe=R.diff(b,"day"),ye=R.diff(G,"day"),he=R.diff(G,"month");pe>0&&he===0&&ye===0&&(w-=j.pull*120)})),Ye=T({pyroxene:w,free_pull:_.value.free_pull}));const De=xt(v,{date:_e});De.length<=0?L.push(null):L.push(De)}c.push(_e),u.push(Ce),y.push(Ye)}x.value.labels=c,x.value.data=[u,y],x.value.pull_banners=L};return xe(()=>{F(),Le(),ee(a.value.format("YYYY"),a.value.format("MM")),te(a.value.format("YYYY"),a.value.format("MM"))}),(c,u)=>(f(),m("div",qs,[o("div",zs,[o("div",Ks,[o("img",{src:p(Os),class:"cursor-pointer select-none",onClick:ie},null,8,Ws),o("span",Js,k(a.value.format("YYYY-MM")),1),o("img",{src:p(Vs),class:"cursor-pointer select-none",onClick:D},null,8,Zs)]),o("div",Qs,[o("div",Xs,[x.value.labels?(f(),He(hs,{key:0,labels:x.value.labels,data:x.value.data,"pull-banners":x.value.pull_banners},null,8,["labels","data","pull-banners"])):Y("",!0)])])]),h(z,{class:"col-span-full md:col-span-3 xl:col-span-2"},{body:P(()=>[en,o("div",tn,[o("div",sn,[o("img",{class:"w-8 mr-2",src:p(H),title:"Pyroxene"},null,8,nn),o("div",null,k(i.current.pyroxene),1)]),o("div",an,[o("img",{class:"w-8 mr-2",src:p(J),title:"Pull Ticket"},null,8,on),o("div",null,k(i.current.free_pull),1)]),o("div",rn,[o("img",{class:"w-8 mr-2",src:p(Be),title:"Total Pull"},null,8,ln),o("div",null,k(i.current.total_pull),1)]),o("div",cn,[o("img",{class:"w-8 mr-2",src:p(ks),title:"Spark"},null,8,un),o("div",null,k(i.current.spark),1)]),dn,o("div",_n,[o("img",{class:"w-8 mr-2",src:p(H),title:"Pyroxene"},null,8,fn),o("div",{class:B({"text-success":i.monthly.total_earn>0,"text-danger":i.monthly.total_earn<0})},[i.monthly.total_earn<0?(f(),m("span",mn,"-")):Y("",!0),i.monthly.total_earn>0?(f(),m("span",pn,"+")):Y("",!0),o("span",null,k(p(C)(i.monthly.total_earn)),1)],2)]),yn,o("div",hn,[o("img",{class:"w-8 mr-2",src:p(H),title:"Pyroxene"},null,8,gn),o("div",{class:B({"text-danger":i.monthly.use_pyroxene<0})},k(i.monthly.use_pyroxene),3)]),o("div",bn,[o("img",{class:"w-8 mr-2",src:p(J),title:"Pull Ticket"},null,8,kn),o("div",{class:B({"text-danger":i.monthly.use_free_pull<0})},k(i.monthly.use_free_pull),3)])])]),_:1}),h(z,{class:"max-h-72 col-span-full md:col-span-2","no-padding":""},{body:P(()=>[o("div",vn,[o("ul",wn,[(f(!0),m(X,null,$e(n.value,y=>(f(),m("li",{key:y.key,class:"col-span-auto"},[o("div",{class:B(["p-3 border-b-2 border-transparent rounded-t-lg cursor-pointer",le(y)]),onClick:b=>M(y.key)},k(y.label),11,xn)]))),128))])]),o("div",$n,[o("div",Bn,[h(W,{modelValue:g.day,"onUpdate:modelValue":u[0]||(u[0]=y=>g.day=y),icon:p(Gs),"icon-title":"Date",type:"date",danger:s.value==="use"},null,8,["modelValue","icon","danger"])]),o("div",Ln,[h(W,{modelValue:g.pyroxene,"onUpdate:modelValue":u[1]||(u[1]=y=>g.pyroxene=y),modelModifiers:{number:!0},placeholder:s.value==="record"?_.value.pyroxene:"0",icon:p(H),"icon-title":"Pyroxene",type:"number",danger:s.value==="use"},null,8,["modelValue","placeholder","icon","danger"])]),o("div",Cn,[h(W,{modelValue:g.free_pull,"onUpdate:modelValue":u[2]||(u[2]=y=>g.free_pull=y),modelModifiers:{number:!0},placeholder:s.value==="record"?_.value.free_pull:"0",icon:p(J),"icon-title":"Free Pull",type:"number",danger:s.value==="use"},null,8,["modelValue","placeholder","icon","danger"])]),o("div",Yn,[h(Ee,{"on-click":ne,primary:s.value==="record",danger:s.value==="use"},{default:P(()=>[ke(" Save ")]),_:1},8,["primary","danger"])])])]),_:1}),h(z,{class:"col-span-full md:col-span-4 xl:col-span-3"},{body:P(()=>[Mn,h(As,{class:"max-h-56 overflow-auto pr-2",items:d.value,"currency-use":l.value},null,8,["items","currency-use"])]),_:1}),h(z,{class:"col-span-full overflow-auto md:col-span-4 xl:col-span-3"},{body:P(()=>[Dn,h(Es,{class:"max-h-56 overflow-auto pr-2"})]),_:1}),o("div",An,[o("div",Pn,[o("img",{class:"inline-block max-w-36",src:p(js),title:"My Wife!!!"},null,8,Un)])])]))}},Rn=lt({history:it(),routes:[{path:kt(""),component:Vt,children:[{path:"",component:Nn}]}]});ct(bt).use(At).use(Rn).mount("#app");
