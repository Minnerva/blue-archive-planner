import{u as S,c as ue,o as c,a as u,b as r,d as p,t as L,e as T,g as ie,G as Ie,s as Ne,f as He,h as R,i as Oe,j as Te,k as V,l as Ve,r as we,m as f,F as J,n as Z,p as Fe,q as Ee,v as ve,w as Ge,x as je,y as qe,z as he,A as Ke,B as ze,D as We,E as Je,H as Ze,I as Qe,J as re,K as Q,L as $,M,N as xe,O as le,P as $e,Q as de,R as Le,S as Xe,T as et,U as tt,V as st}from"./vendor-BQVWAgHc.js";import{C as ye}from"./chart.js-ddEKr6i1.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();const at="/gacha-tracker-online/assets/logo-QuR3q7Cb.png",nt={class:"w-full h-12 bg-white shadow md:px-4 sm:px-6 px-4 sticky top-0"},ot={class:"flex h-full items-center"},it={class:"flex-none w-14"},rt=["src"],lt={class:"flex-1 flex justify-end items-center"},ct=["title"],ut={class:"w-20"},dt={__name:"Nav",setup(e){const t=S(),s=ue(()=>t.state.user),a=()=>{const o=ie(),i=new Ie;Ne(o,i).then(l=>{}).catch(l=>{console.log(l)})},n=()=>{const o=ie();He(o).then(i=>{}).catch(i=>{console.log(i)})};return(o,i)=>(c(),u("div",nt,[r("div",ot,[r("div",it,[r("img",{src:p(at)},null,8,rt)]),r("div",lt,[s.value?(c(),u("span",{key:0,class:"mr-3 truncate max-w-52",title:s.value.ign},L(s.value.ign),9,ct)):T("",!0),r("div",ut,[s.value?(c(),u("button",{key:1,onClick:n,class:"bg-white w-full p-1 border rounded-lg"},"Sign Out")):(c(),u("button",{key:0,onClick:a,class:"bg-white w-full p-1 border rounded-lg"},"Sign In"))])])])]))}},_t={__name:"App",setup(e){R.extend(Oe);const t=S(),a=Te({apiKey:"AIzaSyB8hRY_mV19i_4K-Mno7Sn8FpOJGEIvDKM",authDomain:"gacha-tracker-online.firebaseapp.com",projectId:"gacha-tracker-online",storageBucket:"gacha-tracker-online.appspot.com",messagingSenderId:"395636017581",appId:"1:395636017581:web:2f03e7f80569c9a537b924",measurementId:"G-HW1B3NSFH8",databaseURL:"https://gacha-tracker-online-default-rtdb.asia-southeast1.firebasedatabase.app/"}),n=ie(a);return V(a),Ve(a),n.onAuthStateChanged(async o=>{if(!o&&t.state.user)window.location.reload();else if(!o)t.commit("setUser",!1);else{t.commit("setUID",o.uid);let i={};const l=R.utc().format("YYYY-MM-DD HH:mm:ss");t.dispatch("setUserListen",m=>{t.state.user||(m?(i={...m},i.last_signed_in_at=l):i={ign:"",active:!1,created_at:l,last_signed_in_at:l},t.dispatch("saveUser",i)),m&&t.commit("setUser",m)})}}),(o,i)=>{const l=we("router-view");return c(),u(J,null,[f(dt),f(l)],64)}}},mt=e=>(e&&e[0]==="/"&&(e=e.substring(1)),`/gacha-tracker-online/${e||""}`),pt=(e,t)=>{let s=-1;const a=Object.keys(t);return e.forEach((n,o)=>{const i=[];if(a.forEach(l=>{n[l]===t[l]&&i.push(!0)}),i.length===a.length)return s=o,o}),s},ft=(e,t)=>e.filter(s=>{let a=[];for(let n in t)a.push(t[n]===s[n]);return a.every(n=>n)}),ht=(e,t)=>{const s=[];for(let a in e)s.push(e[a]);return ft(s,t)},Be=(e,t)=>{const s=pt(e,t);return s>-1?e[s]:!1},P=e=>R(`${e} 00:00:00`),K=({pyroxene:e,free_pull:t})=>Math.floor(e/120)+t,yt=e=>Math.floor(e/200),ge=e=>new Intl.NumberFormat("en-US",{}).format(e),gt=async e=>{const t=V();try{const a=(await Ee(Fe(Z(t),e))).val();return a||!1}catch(s){console.error(s)}},bt=(e,t)=>{const s=V(),a=Z(s,e);ve(a,n=>{const o=n.val();t(o)})},z=(e,t)=>{const s=V();Ge(Z(s,e),t)},j=(e,t,s={})=>{s.filters||(s.filters=[]);const a=V(),n=[];let o=null;switch(s.order){case"child":n.push(qe(s.order_key));break;case"key":n.push(je());break;case"value":n.push(orderByValue(s.order_key));break}s.filters.forEach(i=>{switch(i.type){case"first":n.push(Je(i.value));break;case"last":n.push(We(i.value));break;case"between":s.order==="key"&&(n.push(he(i.start)),n.push(ze(i.end)));break;case"endBefore":s.order==="key"&&n.push(Ke(i.value));break;case"startAt":s.order==="key"&&n.push(he(i.value));break}}),o=Ze(Z(a,e),...n),ve(o,i=>t(i.val()))},kt={namespaced:!0,state:{DB_PATH_BA_BANNER_PULL:"/ba-banner-pull",banner_pull:!1,listGetUpcomingListener:!1},mutations:{setBannerPull(e,t){e.banner_pull=t?{...t}:!1}},getters:{find:e=>t=>{const s=e.banner_pull[t];return s||null}},actions:{save({state:e,rootState:t},{key:s,data:a}){z(`${e.DB_PATH_BA_BANNER_PULL}/${t.uid}/${s}`,a)},delete({state:e,rootState:t},s){z(`${e.DB_PATH_BA_BANNER_PULL}/${t.uid}/${s}`,null)},setGetUpcomingRecordsListen({state:e,rootState:t},s){const{listGetUpcomingListener:a}=e;a&&(a.off(),e.listGetUpcomingListener=!1),e.listLatestListener=j(`${e.DB_PATH_BA_BANNER_PULL}/${t.uid}`,s,{order:"key",filters:[{type:"startAt",value:"2023-12-00"}]})}}},wt={namespaced:!0,state:{DB_PATH_BA_CURRENCY_OWN:"/ba-currency-own",listGetListener:!1,listLatestListener:!1,listLatestBeforeMonthListener:!1},actions:{save({state:e,rootState:t},{key:s,data:a}){z(`${e.DB_PATH_BA_CURRENCY_OWN}/${t.uid}/${s}`,a)},setGetRecordsListen({state:e,rootState:t},{year:s,month:a,callback:n}){const{listGetListener:o}=e;o&&(o.off(),e.listGetListener=!1),e.listLatestListener=j(`${e.DB_PATH_BA_CURRENCY_OWN}/${t.uid}`,n,{order:"key",filters:[{type:"between",start:`${s}-${a}-00`,end:`${s}-${a}-99`}]})},setGetLatestRecordListen({state:e,rootState:t},s){const{listLatestListener:a}=e;a&&(a.off(),e.listLatestListener=!1),e.listLatestListener=j(`${e.DB_PATH_BA_CURRENCY_OWN}/${t.uid}`,s,{filters:[{type:"last",value:1}]})},setGetLatestBeforeMonthListener({state:e,rootState:t},{year:s,month:a,callback:n}){const{listLatestBeforeMonthListener:o}=e;o&&(o.off(),e.listLatestBeforeMonthListener=!1),e.listLatestBeforeMonthListener=j(`${e.DB_PATH_BA_CURRENCY_OWN}/${t.uid}`,n,{order:"key",filters:[{type:"endBefore",value:`${s}-${a}-00`},{type:"last",value:1}]})}}},vt={"ba-banner-pull":kt,"ba-currency-own":wt},xt=Qe({state:{DB_PATH_USER:"/users",DB_PATH_BLUE_ARCHIVE_CURRENCY:"/blue-archive-currencies",user:!1,uid:!1},mutations:{setUser(e,t){e.user=t?{...t}:!1},setUID(e,t){e.uid=t||!1}},actions:{findUser({state:e}){return gt(`${e.DB_PATH_USER}/${e.uid}`)},setUserListen({state:e},t){bt(`${e.DB_PATH_USER}/${e.uid}`,s=>t(s))},async saveUser({state:e},t){await z(`${e.DB_PATH_USER}/${e.uid}`,t)}},modules:vt}),Ce=(e,t)=>{const s=e.__vccOpts||e;for(const[a,n]of t)s[a]=n;return s},$t={},Lt={class:"relative shadow bg-white rounded-sm"},Bt={class:"p-3"};function Ct(e,t){return c(),u("div",Lt,[re(e.$slots,"cover"),r("div",Bt,[re(e.$slots,"body")])])}const q=Ce($t,[["render",Ct]]),At={class:"relative"},Dt=["src","title"],Mt=["placeholder","type","value"],Pt={__name:"Base",props:{icon:{},iconTitle:{},modelValue:{},type:{default:"text"},placeholder:{default:""},onChange:{type:Function,default(){return()=>{}}}},emits:["update:modelValue"],setup(e){return(t,s)=>(c(),u("div",At,[e.icon?(c(),u("img",{key:0,class:"absolute w-8 max-h-5 inset-y-0 m-auto z-10",src:e.icon,title:e.iconTitle},null,8,Dt)):T("",!0),r("input",{class:Q(["w-full h-7 border-primary border-2 drop-shadow-sm focus:outline-0",{"pl-4":!e.icon,"pl-9":e.icon}]),placeholder:e.placeholder,type:e.type,value:e.modelValue,onInput:s[0]||(s[0]=a=>t.$emit("update:modelValue",a.target.value)),onChange:s[1]||(s[1]=(...a)=>e.onChange&&e.onChange(...a))},null,42,Mt)]))}},O=Ce(Pt,[["__scopeId","data-v-df7366c4"]]),Ae={__name:"Base",props:{primary:Boolean,onClick:Function},setup(e){const t=e,s={"border-2":!t.primary,"text-white":t.primary,"bg-primary":t.primary};return(a,n)=>(c(),u("button",{class:Q(["rounded w-full h-8 select-none",s]),onClick:n[0]||(n[0]=(...o)=>e.onClick&&e.onClick(...o))},[re(a.$slots,"default")]))}},Rt={class:"w-full py-3 md:px-8 sm:px-6 px-4"},St={key:0},Ut={class:"grid grid-cols-2 gap-4"},Yt={class:"col-span-full md:col-span-1"},It={key:1},Nt={__name:"Main",setup(e){const t=S(),s=ue(()=>t.state.user),a=$(""),n=()=>{const{user:o}=t.state;o.ign=a,t.dispatch("saveUser",o)};return(o,i)=>{const l=we("router-view");return c(),u("div",Rt,[s.value?(c(),u(J,{key:0},[s.value.ign?s.value.active?(c(),xe(l,{key:2})):(c(),u("div",It,"Please contact Minnerva to activate your account.")):(c(),u("div",St,[f(q,null,{body:M(()=>[r("div",Ut,[r("label",Yt,[le(" Input your IGN or Discord Name: "),f(O,{modelValue:a.value,"onUpdate:modelValue":i[0]||(i[0]=m=>a.value=m)},null,8,["modelValue"])]),f(Ae,{class:"col-span-full md:col-start-1 md:col-end-2","on-click":n,primary:""},{default:M(()=>[le("Submit")]),_:1})])]),_:1})]))],64)):T("",!0)])}}},Ht="/gacha-tracker-online/assets/akane-bunny-icon-gfOjhgOr.webp",Ot="/gacha-tracker-online/assets/asuna-bunny-icon-oF1effRe.webp",Tt="/gacha-tracker-online/assets/hanako-swimsuit-icon-s2k28dzI.webp",Vt="/gacha-tracker-online/assets/hare-camp-icon-xHKeVTgU.webp",Ft="/gacha-tracker-online/assets/haruna-tracksuit-icon-C3yJc6jX.webp",Et="/gacha-tracker-online/assets/himari-icon-NnOzyjRg.webp",Gt="/gacha-tracker-online/assets/hina-swimsuit-icon-3-IoiTOU.webp",jt="/gacha-tracker-online/assets/hinata-swimsuit-icon-Vx2yAU8s.webp",qt="/gacha-tracker-online/assets/iori-swimsuit-icon-5HfIKnaa.webp",Kt="/gacha-tracker-online/assets/karin-bunny-icon-z90yfVlX.webp",zt="/gacha-tracker-online/assets/kayoko-new-year-icon-lEZ08tqZ.webp",Wt="/gacha-tracker-online/assets/kikyou-icon-OCtBoToh.webp",Jt="/gacha-tracker-online/assets/kotama-camp-icon-j0Rln9bx.webp",Zt="/gacha-tracker-online/assets/mari-tracksuit-icon-IfCWZ2Vl.webp",Qt="/gacha-tracker-online/assets/mimori-swimsuit-icon-ICDRkuj4.webp",Xt="/gacha-tracker-online/assets/misaka-mikoto-icon-t-m5DYfT.webp",es="/gacha-tracker-online/assets/miyako-swimsuit-icon-9NTUwO2x.webp",ts="/gacha-tracker-online/assets/neru-bunny-icon-QPIKLGG6.webp",ss="/gacha-tracker-online/assets/nonomi-swimsuit-icon-Yyj40vp2.webp",as="/gacha-tracker-online/assets/renge-icon-nMq9xxcQ.webp",ns="/gacha-tracker-online/assets/saki-swimsuit-icon-y07xpALf.webp",os="/gacha-tracker-online/assets/shiroko-swimsuit-icon-gmc76iBJ.webp",is="/gacha-tracker-online/assets/shokuhou-misaki-icon-r8ShdIbR.webp",rs="/gacha-tracker-online/assets/ui-swimsuit-icon-Y8SkXBci.webp",ls="/gacha-tracker-online/assets/wakamo-swimsuit-icon-aFL8264u.webp",cs="/gacha-tracker-online/assets/yukari-icon-lJbTFHeZ.webp",us="/gacha-tracker-online/assets/yuuka-tracksuit-icon-obYhk5gg.webp";let ce=[{name:"Akane",alter:"Bunny"},{name:"Asuna",alter:"Bunny"},{name:"Hanako",alter:"Swimsuit"},{name:"Hare",alter:"Camp"},{name:"Haruna",alter:"Tracksuit"},{name:"Himari",alter:""},{name:"Hina",alter:"Swimsuit"},{name:"Hinata",alter:"Swimsuit"},{name:"Iori",alter:"Swimsuit"},{name:"Karin",alter:"Bunny"},{name:"Kayoko",alter:"New Year"},{name:"Kikyou",alter:""},{name:"Kotama",alter:"Camp"},{name:"Mari",alter:"Tracksuit"},{name:"Mimori",alter:"Swimsuit"},{name:"Misaka Mikoto",alter:""},{name:"Miyako",alter:"Swimsuit"},{name:"Neru",alter:"Bunny"},{name:"Nonomi",alter:"Swimsuit"},{name:"Renge",alter:""},{name:"Saki",alter:"Swimsuit"},{name:"Shiroko",alter:"Swimsuit"},{name:"Shokuhou Misaki",alter:""},{name:"Ui",alter:"Swimsuit"},{name:"Wakamo",alter:"Swimsuit"},{name:"Yukari",alter:""},{name:"Yuuka",alter:"Tracksuit"}];ce=ce.map(e=>(e.full_name=e.alter?`${e.name} (${e.alter})`:e.name,e.key=e.full_name.replace(/[()]/g,"").replace(/\s/g,"-").toLocaleLowerCase(),e.icon=new URL(Object.assign({"/src/assets/students/akane-bunny-icon.webp":Ht,"/src/assets/students/asuna-bunny-icon.webp":Ot,"/src/assets/students/hanako-swimsuit-icon.webp":Tt,"/src/assets/students/hare-camp-icon.webp":Vt,"/src/assets/students/haruna-tracksuit-icon.webp":Ft,"/src/assets/students/himari-icon.webp":Et,"/src/assets/students/hina-swimsuit-icon.webp":Gt,"/src/assets/students/hinata-swimsuit-icon.webp":jt,"/src/assets/students/iori-swimsuit-icon.webp":qt,"/src/assets/students/karin-bunny-icon.webp":Kt,"/src/assets/students/kayoko-new-year-icon.webp":zt,"/src/assets/students/kikyou-icon.webp":Wt,"/src/assets/students/kotama-camp-icon.webp":Jt,"/src/assets/students/mari-tracksuit-icon.webp":Zt,"/src/assets/students/mimori-swimsuit-icon.webp":Qt,"/src/assets/students/misaka-mikoto-icon.webp":Xt,"/src/assets/students/miyako-swimsuit-icon.webp":es,"/src/assets/students/neru-bunny-icon.webp":ts,"/src/assets/students/nonomi-swimsuit-icon.webp":ss,"/src/assets/students/renge-icon.webp":as,"/src/assets/students/saki-swimsuit-icon.webp":ns,"/src/assets/students/shiroko-swimsuit-icon.webp":os,"/src/assets/students/shokuhou-misaki-icon.webp":is,"/src/assets/students/ui-swimsuit-icon.webp":rs,"/src/assets/students/wakamo-swimsuit-icon.webp":ls,"/src/assets/students/yukari-icon.webp":cs,"/src/assets/students/yuuka-tracksuit-icon.webp":us})[`/src/assets/students/${e.key}-icon.webp`],import.meta.url).href,e));const De=ce,Me="/gacha-tracker-online/assets/pyroxene-gBHgCIjf.webp",Pe="/gacha-tracker-online/assets/recruitment-ticket-NiO_EDI9.webp",be="chart",ds={__name:"LineChart",props:{labels:{type:Array,required:!0},data:{type:Array,required:!0},pullBanners:{type:Array,default(){return[]}}},setup(e,{expose:t}){const s=e;let a=null;const n={};$e(s,()=>{o()}),ye.register({id:"default",afterDatasetsDraw(l){const m=l.getDatasetMeta(0).data;if(m.length>0){const{ctx:k}=l,x=14*l.currentDevicePixelRatio,U=16*l.currentDevicePixelRatio;m.forEach(({$context:F},B)=>{const Y=l.getDatasetMeta(1).data[B],I=F.raw,E=Y.$context.raw;if((I||E)&&s.pullBanners[B]){const d=I?m[B].x:Y.x,_=I?m[B].y:Y.y;s.pullBanners[B].forEach((w,g)=>{const b=Be(De,{key:w.student_key});if(b){if(!n[b.key]){const y=new Image(x,U);y.src=b.icon,n[b.key]=y}k.drawImage(n[b.key],d-x/2,_-(-10+g*-1*U),x,U)}})}})}}});const o=()=>{a.data.labels=s.labels,s.data.forEach((l,m)=>{a.data.datasets[m].data=l}),a.update()},i=()=>{a=new ye(document.querySelector(`#${be}`),{type:"line",data:{labels:[],datasets:[{data:[],borderColor:"#00D8FB",backgroundColor:"#FFFFFF"},{data:[],borderColor:"#FFE9F2",backgroundColor:"#FFFFFF"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},animation:{},scales:{x:{ticks:{autoSkip:!0,maxTicksLimit:10}},y:{beginAtZero:!0}}}})};return de(()=>{i()}),t({updateChart:o}),(l,m)=>(c(),u("canvas",{id:be}))}},_s={class:"flex items-center"},ms=["src","title"],G={__name:"HistorySub",props:{icon:{required:!0},iconTitle:{},own:{required:!0},diff:{}},setup(e){const t=a=>{if(a>0)return"text-success";if(a<0)return"text-danger"},s=a=>`(${a>0?"+":""}${ge(a)})`;return(a,n)=>(c(),u("div",_s,[r("img",{class:"w-8 mr-2",src:e.icon,title:e.iconTitle},null,8,ms),r("span",null,L(p(ge)(e.own)),1),e.diff&&e.diff!==0?(c(),u("span",{key:0,class:Q(["ml-1 text-xs",t(e.diff)])},L(s(e.diff)),3)):T("",!0)]))}},Re="/gacha-tracker-online/assets/icon-pulls-PmRtrI9p.png",ps="/gacha-tracker-online/assets/icon-3-stars-unit-G8a83jjO.png",fs={class:"grid grid-cols-2 gap-3"},hs={class:"col-span-1 border-r"},ys={class:"col-span-1"},gs={__name:"History",props:{item:{required:!0}},setup(e){const t=$(R()),s=a=>a===t.value.format("YYYY-MM-DD")?["text-primary","font-bold"]:[];return(a,n)=>(c(),u("div",fs,[r("div",{class:Q(["col-span-2",s(e.item.date)])},L(e.item.date),3),r("div",hs,[f(G,{icon:p(Me),"icon-title":"Pyroxene",own:e.item.pyroxene,diff:e.item.diff_pyroxene},null,8,["icon","own","diff"]),f(G,{icon:p(Pe),"icon-title":"Pull Ticket",own:e.item.free_pull,diff:e.item.diff_free_pull},null,8,["icon","own","diff"])]),r("div",ys,[f(G,{icon:p(Re),"icon-title":"Total Pull",own:p(K)(e.item)},null,8,["icon","own"]),f(G,{icon:p(ps),"icon-title":"Spark",own:p(yt)(p(K)(e.item))},null,8,["icon","own"])])]))}},bs={class:"flow-root"},ks={class:"divide-y divide-gray-200 dark:divide-gray-700"},ws={key:0,class:"py-3 sm:py-4"},vs={__name:"History",props:{items:{required:!0}},setup(e){return(t,s)=>(c(),u("div",bs,[r("ul",ks,[!e.items||e.items.length<=0?(c(),u("li",ws,"No record found.")):(c(!0),u(J,{key:1},Le(e.items,a=>(c(),u("li",{key:a.date,class:"py-3 sm:py-4"},[f(gs,{item:a},null,8,["item"])]))),128))])]))}};let W=[{date:"2023-09-26",duration:7,student_key:"kayoko-new-year"},{date:"2024-01-09",duration:7,student_key:"hina-swimsuit"},{date:"2024-01-09",duration:7,student_key:"iori-swimsuit"},{date:"2023-12-26",duration:14,student_key:"miyako-swimsuit"},{date:"2023-12-26",duration:14,student_key:"saki-swimsuit"},{date:"2024-01-16",duration:7,student_key:"shiroko-swimsuit"},{date:"2024-01-16",duration:7,student_key:"nonomi-swimsuit"},{date:"2024-01-16",duration:7,student_key:"wakamo-swimsuit"},{date:"2024-01-23",duration:9,student_key:"ui-swimsuit"},{date:"2024-01-23",duration:9,student_key:"hinata-swimsuit"},{date:"2024-02-01",duration:7,student_key:"hanako-swimsuit"},{date:"2024-02-15",duration:7,student_key:"mimori-swimsuit"},{date:"2024-03-16",duration:12,student_key:"haruna-tracksuit"},{date:"2024-03-16",duration:12,student_key:"yuuka-tracksuit"},{date:"2024-03-16",duration:12,student_key:"mari-tracksuit"},{date:"2024-04-18",duration:14,student_key:"misaka-mikoto"},{date:"2024-04-18",duration:14,student_key:"shokuhou-misaki"},{date:"2024-05-02",duration:8,student_key:"yukari"},{date:"2024-05-16",duration:14,student_key:"renge"},{date:"2024-05-16",duration:14,student_key:"kikyou"},{date:"2024-05-30",duration:7,student_key:"himari"},{date:"2024-06-13",duration:7,student_key:"karin-bunny"},{date:"2024-06-13",duration:7,student_key:"neru-bunny"},{date:"2024-06-13",duration:7,student_key:"akane-bunny"},{date:"2024-06-13",duration:7,student_key:"asuna-bunny"},{date:"2024-06-20",duration:14,student_key:"hare-camp"},{date:"2024-06-20",duration:14,student_key:"kotama-camp"}];W=W.map(e=>(e.key=`${e.date}-${e.student_key}`,e));W.sort((e,t)=>e.date>t.date?1:e.date<t.date?-1:0);const xs=W,$s={class:"grid grid-cols-10 gap-3 md:items-center"},Ls={class:"col-span-2 lg:col-span-2"},Bs=["src","title"],Cs={class:"col-span-8 lg:col-span-8"},As={__name:"Banner",props:{item:{required:!0},bannerPull:{}},setup(e){const t=e,s=S(),a=$(null),n=Be(De,{key:t.item.student_key});$e(t,()=>{o()});const o=()=>{const m=s.getters["ba-banner-pull/find"](t.item.key);a.value=m?m.pull:null},i=()=>t.item.diff<=0?" - Live":` - ${t.item.diff} days`,l=()=>{const{item:m}=t,k=m.key;!a.value||a.value<=0?(s.dispatch("ba-banner-pull/delete",k),a.value=null):s.dispatch("ba-banner-pull/save",{key:k,data:{date:m.date,student_key:m.student_key,pull:a.value}})};return de(()=>{o()}),(m,k)=>(c(),u("div",$s,[r("div",Ls,[r("img",{src:p(n).icon,title:p(n).full_name},null,8,Bs)]),r("div",Cs,[r("div",null,L(e.item.date)+L(i()),1),r("div",null,L(p(n).full_name),1),r("div",null,[f(O,{modelValue:a.value,"onUpdate:modelValue":k[0]||(k[0]=x=>a.value=x),modelModifiers:{number:!0},placeholder:"200",icon:p(Re),"icon-title":"Pull",type:"number","on-change":l},null,8,["modelValue","icon"])])])]))}},Ds={class:"flow-root"},Ms={class:"divide-y divide-gray-200 dark:divide-gray-700"},Ps={key:0,class:"py-3 sm:py-4"},Rs={__name:"Banner",setup(e){const t=S(),s=ue(()=>t.state["ba-banner-pull"].banner_pull),a=P(R().format("YYYY-MM-DD")),n=xs.map(o=>{const i=P(o.date);return o.diff=i.diff(a,"day"),o}).filter(o=>o.diff>o.duration*-1);return(o,i)=>(c(),u("div",Ds,[r("ul",Ms,[p(n).length<=0?(c(),u("li",Ps,"No banner found.")):(c(!0),u(J,{key:1},Le(p(n),l=>(c(),u("li",{key:l.key,class:"py-3 sm:py-4"},[f(As,{item:l,"banner-pull":s.value[l.key]},null,8,["item","banner-pull"])]))),128))])]))}},Ss="data:image/svg+xml,%3c!--%20https://fontawesome.com/icons/chevron-left?f=classic&s=solid%20--%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='16'%20width='10'%20viewBox='0%200%20320%20512'%3e%3c!--!Font%20Awesome%20Free%206.5.1%20by%20@fontawesome%20-%20https://fontawesome.com%20License%20-%20https://fontawesome.com/license/free%20Copyright%202023%20Fonticons,%20Inc.--%3e%3cpath%20d='M9.4%20233.4c-12.5%2012.5-12.5%2032.8%200%2045.3l192%20192c12.5%2012.5%2032.8%2012.5%2045.3%200s12.5-32.8%200-45.3L77.3%20256%20246.6%2086.6c12.5-12.5%2012.5-32.8%200-45.3s-32.8-12.5-45.3%200l-192%20192z'/%3e%3c/svg%3e",Us="data:image/svg+xml,%3c!--%20https://fontawesome.com/icons/chevron-right?f=classic&s=solid%20--%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='16'%20width='10'%20viewBox='0%200%20320%20512'%3e%3c!--!Font%20Awesome%20Free%206.5.1%20by%20@fontawesome%20-%20https://fontawesome.com%20License%20-%20https://fontawesome.com/license/free%20Copyright%202023%20Fonticons,%20Inc.--%3e%3cpath%20d='M310.6%20233.4c12.5%2012.5%2012.5%2032.8%200%2045.3l-192%20192c-12.5%2012.5-32.8%2012.5-45.3%200s-12.5-32.8%200-45.3L242.7%20256%2073.4%2086.6c-12.5-12.5-12.5-32.8%200-45.3s32.8-12.5%2045.3%200l192%20192z'/%3e%3c/svg%3e",Ys="data:image/svg+xml,%3c!--%20https://fontawesome.com/icons/calendar?f=classic&s=regular&pc=%252300d8fb%20--%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='16'%20width='14'%20viewBox='0%200%20448%20512'%3e%3c!--!Font%20Awesome%20Free%206.5.1%20by%20@fontawesome%20-%20https://fontawesome.com%20License%20-%20https://fontawesome.com/license/free%20Copyright%202023%20Fonticons,%20Inc.--%3e%3cpath%20fill='%2300d8fb'%20d='M152%2024c0-13.3-10.7-24-24-24s-24%2010.7-24%2024V64H64C28.7%2064%200%2092.7%200%20128v16%2048V448c0%2035.3%2028.7%2064%2064%2064H384c35.3%200%2064-28.7%2064-64V192%20144%20128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24%2010.7-24%2024V64H152V24zM48%20192H400V448c0%208.8-7.2%2016-16%2016H64c-8.8%200-16-7.2-16-16V192z'/%3e%3c/svg%3e",Is="/gacha-tracker-online/assets/arona-head-5uMSPBb2.png",Ns="/gacha-tracker-online/assets/mika-portrait-iOc64siT.webp",Hs={class:"grid grid-cols-7 gap-4"},Os={class:"col-span-full md:col-span-5"},Ts={class:"flex justify-center text-center"},Vs=["src"],Fs={class:"mx-4 text-xl md:text-3xl font-bold"},Es=["src"],Gs={class:"flex justify-center"},js={class:"w-full h-72"},qs=r("div",{class:"mb-3 text-md md:text-xl font-bold"},"Add",-1),Ks={class:"grid grid-cols-4 gap-4"},zs={class:"col-span-full"},Ws={class:"col-span-2"},Js={class:"col-span-2"},Zs={class:"col-span-full md:col-start-2 md:col-end-4 mt-4"},Qs=["src"],Xs=r("div",{class:"text-md0 md:text-xl font-bold"},"History",-1),ea=r("div",{class:"text-md0 md:text-xl font-bold"},"Upcoming Banners",-1),ta={class:"col-span-full md:col-span-1 xl:col-span-2 grid items-center content-end"},sa={class:"text-center"},aa=["src"],ke=12e3/30,na={__name:"Index",setup(e){const t=S(),s=$(R()),a=$([]),n=$([]),o=$({date:"",pyroxene:0,free_pull:0}),i=Xe({day:s.value.format("YYYY-MM-DD"),pyroxene:void 0,free_pull:void 0}),l=$({labels:[],data:[],pull_banners:[]}),m=()=>{t.dispatch("ba-currency-own/setGetLatestRecordListen",d=>{if(d){const _=Object.keys(d);_.length>0&&(o.value={date:_[0],...d[_[0]]})}})},k=(d,_)=>{t.dispatch("ba-currency-own/setGetLatestBeforeMonthListener",{year:d,month:_,callback:h=>{const w=[];let g=[],b=0;a.value&&(g=Object.keys(a.value),g.reverse(),b=g.length);for(let y=0;y<b;y++){const C=a.value[g[y]];let v=a.value[g[y+1]];const A={date:g[y],pyroxene:C.pyroxene,free_pull:C.free_pull,diff_pyroxene:null,diff_free_pull:null};!v&&h&&(v=h[Object.keys(h)[0]]),v&&(A.diff_pyroxene=C.pyroxene-v.pyroxene,A.diff_free_pull=C.free_pull-v.free_pull),w.push(A)}n.value=w}})},x=(d,_)=>{t.dispatch("ba-currency-own/setGetRecordsListen",{year:d,month:_,callback:h=>{a.value=h,E(),k(d,_)}})},U=()=>{t.dispatch("ba-banner-pull/setGetUpcomingRecordsListen",d=>{t.commit("ba-banner-pull/setBannerPull",d)})},F=d=>{s.value=d,x(d.year(),d.month()+1)},B=()=>{const d=s.value.add(-1,"month").startOf("month");F(d)},Y=()=>{const d=s.value.add(1,"month").startOf("month");F(d)},I=async()=>{const d=P(i.day),_={pyroxene:i.pyroxene,free_pull:i.free_pull};isNaN(_.pyroxene)&&(_.pyroxene=o.value?o.value.pyroxene:0),isNaN(_.free_pull)&&(_.free_pull=o.value?o.value.free_pull:0),t.dispatch("ba-currency-own/save",{key:d.format("YYYY-MM-DD"),data:_}),i.pyroxene=void 0,i.free_pull=void 0,E()},E=()=>{const d=[],_=[],h=[],w=o.value?P(o.value.date):!1,g=t.state["ba-banner-pull"].banner_pull,b=Object.keys(g);let y=!1,C=!1;const v=[],A=s.value.startOf("month"),Se=s.value.endOf("month"),Ue=A.diff(Se,"day")*-1+1;for(let X=0;X<Ue;X++){const N=A.add(X,"day"),ee=N.format("YYYY-MM-DD"),te=a.value?a.value[ee]:!1;let _e=null,me=null;if(te&&(_e=K({pyroxene:te.pyroxene,free_pull:te.free_pull})),w){const pe=w.diff(N,"day");pe<=0&&(y===!1?y=pe*-1*ke+o.value.pyroxene:y+=ke,g&&(C||(b.forEach(se=>{const H=g[se],D=P(H.date),ae=D.diff(w,"day"),ne=D.startOf("month"),oe=N.startOf("month"),Ye=ne.diff(oe,"month");ae>0&&Ye<0&&(y-=H.pull*120)}),C=!0),b.forEach(se=>{const H=g[se],D=P(H.date),ae=D.diff(w,"day"),ne=D.diff(N,"day"),oe=D.diff(N,"month");ae>0&&oe===0&&ne===0&&(y-=H.pull*120)})),me=K({pyroxene:y,free_pull:o.value.free_pull}));const fe=ht(g,{date:ee});fe.length<=0?v.push(null):v.push(fe)}d.push(ee),_.push(_e),h.push(me)}l.value.labels=d,l.value.data=[_,h],l.value.pull_banners=v};return de(()=>{m(),U(),x(s.value.format("YYYY"),s.value.format("MM"))}),(d,_)=>(c(),u("div",Hs,[r("div",Os,[r("div",Ts,[r("img",{src:p(Ss),class:"cursor-pointer select-none",onClick:B},null,8,Vs),r("span",Fs,L(s.value.format("YYYY-MM")),1),r("img",{src:p(Us),class:"cursor-pointer select-none",onClick:Y},null,8,Es)]),r("div",Gs,[r("div",js,[l.value.labels?(c(),xe(ds,{key:0,labels:l.value.labels,data:l.value.data,"pull-banners":l.value.pull_banners},null,8,["labels","data","pull-banners"])):T("",!0)])])]),f(q,{class:"col-span-full md:col-span-2"},{body:M(()=>[qs,r("div",Ks,[r("div",zs,[f(O,{modelValue:i.day,"onUpdate:modelValue":_[0]||(_[0]=h=>i.day=h),icon:p(Ys),"icon-title":"Date",type:"date"},null,8,["modelValue","icon"])]),r("div",Ws,[f(O,{modelValue:i.pyroxene,"onUpdate:modelValue":_[1]||(_[1]=h=>i.pyroxene=h),modelModifiers:{number:!0},placeholder:o.value.pyroxene,icon:p(Me),"icon-title":"Pyroxene",type:"number"},null,8,["modelValue","placeholder","icon"])]),r("div",Js,[f(O,{modelValue:i.free_pull,"onUpdate:modelValue":_[2]||(_[2]=h=>i.free_pull=h),modelModifiers:{number:!0},placeholder:o.value.free_pull,icon:p(Pe),"icon-title":"Free Pull",type:"number"},null,8,["modelValue","placeholder","icon"])]),r("div",Zs,[f(Ae,{"on-click":I,primary:""},{default:M(()=>[le(" Save ")]),_:1})])]),r("img",{src:p(Is),class:"h-32 mt-4 md:mt-0 md:absolute bottom-0 inset-x-0 m-auto"},null,8,Qs)]),_:1}),f(q,{class:"h-72 col-span-full overflow-auto md:col-span-3"},{body:M(()=>[Xs,f(vs,{items:n.value},null,8,["items"])]),_:1}),f(q,{class:"max-h-72 col-span-full overflow-auto md:col-span-3 xl:col-span-2"},{body:M(()=>[ea,f(Rs)]),_:1}),r("div",ta,[r("div",sa,[r("img",{class:"inline-block max-w-36",src:p(Ns),title:"My Wife!!!"},null,8,aa)])])]))}},oa=et({history:tt(),routes:[{path:mt(""),component:Nt,children:[{path:"",component:na}]}]});st(_t).use(xt).use(oa).mount("#app");
